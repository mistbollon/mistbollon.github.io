<!DOCTYPE html>
<html lang='zh-CN'>

<head>
  <meta name="generator" content="Hexo 6.3.0">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.18.5">
  <meta charset="utf-8">
  

  <meta http-equiv='x-dns-prefetch-control' content='on' />
  <link rel='dns-prefetch' href='https://gcore.jsdelivr.net'>
  <link rel="preconnect" href="https://gcore.jsdelivr.net" crossorigin>
  <link rel='dns-prefetch' href='//unpkg.com'>

  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  
  <title>JavaScript面试题 - GuoPeng Blog</title>

  
    <meta name="description" content="01. 变量赋值JavaScript 中的基本数据类型包括字符串、数值、布尔值、undefined、Symbol。 JavaScript 中的引用数据类型包括对象、数组、函数、null。 1234let m &#x3D; 100;let n &#x3D; m;m &#x3D; 200;console.log(n); &#x2F;&#x2F; ?  基本数据类型在进行变量赋值时采用的是复制值的方式，n &#x3D; m 其实就是将 m 变量的值 1">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaScript面试题">
<meta property="og:url" content="http://example.com/%E9%9D%A2%E8%AF%95%E9%A2%98/JavaScript%E9%9D%A2%E8%AF%95%E9%A2%98/index.html">
<meta property="og:site_name" content="GuoPeng Blog">
<meta property="og:description" content="01. 变量赋值JavaScript 中的基本数据类型包括字符串、数值、布尔值、undefined、Symbol。 JavaScript 中的引用数据类型包括对象、数组、函数、null。 1234let m &#x3D; 100;let n &#x3D; m;m &#x3D; 200;console.log(n); &#x2F;&#x2F; ?  基本数据类型在进行变量赋值时采用的是复制值的方式，n &#x3D; m 其实就是将 m 变量的值 1">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/%E9%9D%A2%E8%AF%95%E9%A2%98/JavaScript%E9%9D%A2%E8%AF%95%E9%A2%98/assets/03.png">
<meta property="og:image" content="http://example.com/%E9%9D%A2%E8%AF%95%E9%A2%98/JavaScript%E9%9D%A2%E8%AF%95%E9%A2%98/assets/04.png">
<meta property="og:image" content="http://example.com/%E9%9D%A2%E8%AF%95%E9%A2%98/JavaScript%E9%9D%A2%E8%AF%95%E9%A2%98/assets/05.png">
<meta property="og:image" content="http://example.com/%E9%9D%A2%E8%AF%95%E9%A2%98/JavaScript%E9%9D%A2%E8%AF%95%E9%A2%98/assets/06.png">
<meta property="og:image" content="http://example.com/%E9%9D%A2%E8%AF%95%E9%A2%98/JavaScript%E9%9D%A2%E8%AF%95%E9%A2%98/assets/07.png">
<meta property="og:image" content="http://example.com/%E9%9D%A2%E8%AF%95%E9%A2%98/JavaScript%E9%9D%A2%E8%AF%95%E9%A2%98/assets/08.png">
<meta property="og:image" content="http://example.com/%E9%9D%A2%E8%AF%95%E9%A2%98/JavaScript%E9%9D%A2%E8%AF%95%E9%A2%98/assets/09.png">
<meta property="article:published_time" content="2023-05-12T13:19:17.248Z">
<meta property="article:modified_time" content="2023-05-12T13:24:55.319Z">
<meta property="article:author" content="陈国朋">
<meta property="article:tag" content="面试题">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/%E9%9D%A2%E8%AF%95%E9%A2%98/JavaScript%E9%9D%A2%E8%AF%95%E9%A2%98/assets/03.png">
  
  

  <!-- feed -->
  

  
    
<link rel="stylesheet" href="/css/main.css">

  

  
    <link rel="shortcut icon" href="/images/icon.svg">
  

  

  


  
</head>

<body>
  




  <div class='l_body' id='start'>
    <aside class='l_left' layout='post'>
    

  

<header class="header"><div class="logo-wrap"><a class="avatar" href="/about/"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/avatar/round/rainbow64@3x.webp);"></div><img no-lazy class="avatar" src="/images/snow-leopard.png" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/image/2659360.svg';"></a><a class="title" href="/"><div class="main" ff="title">GuoPeng</div><div class="sub normal cap">欢迎来到我的博客</div><div class="sub hover cap" style="opacity:0"> 淡泊明志</div></a></div>

<nav class="menu dis-select"><a class="nav-item active" href="/">笔记</a><a class="nav-item" href="/wiki/">项目</a><a class="nav-item" href="/about/">关于</a></nav>
</header>


<div class="widgets">
<widget class="widget-wrapper search"><div class="widget-body"><div class="search-wrapper" id="search"><form class="search-form"><input type="text" class="search-input" id="search-input" data-filter="/blog/" placeholder="搜索"><svg t="1670596976048" class="icon search-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2676" width="200" height="200"><path d="M938.2 832.6L723.8 618.1c-2.5-2.5-5.3-4.4-7.9-6.4 36.2-55.6 57.3-121.8 57.3-193.1C773.3 222.8 614.6 64 418.7 64S64 222.8 64 418.6c0 195.9 158.8 354.6 354.6 354.6 71.3 0 137.5-21.2 193.2-57.4 2 2.7 3.9 5.4 6.3 7.8L832.5 938c14.6 14.6 33.7 21.9 52.8 21.9 19.1 0 38.2-7.3 52.8-21.8 29.2-29.1 29.2-76.4 0.1-105.5M418.7 661.3C284.9 661.3 176 552.4 176 418.6 176 284.9 284.9 176 418.7 176c133.8 0 242.6 108.9 242.6 242.7 0 133.7-108.9 242.6-242.6 242.6" p-id="2677"></path></svg></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div></div></widget>


<widget class="widget-wrapper toc single" id="data-toc"><div class="widget-header cap dis-select"><span class="name">JavaScript面试题</span></div><div class="widget-body fs14"><div class="doc-tree active"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#01-%E5%8F%98%E9%87%8F%E8%B5%8B%E5%80%BC"><span class="toc-text">01. 变量赋值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#02-typeof-%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">02. typeof 运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#03-%E6%B7%B1%E6%8B%B7%E8%B4%9D"><span class="toc-text">03. 深拷贝</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#04-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E8%A7%84%E5%88%99"><span class="toc-text">04. 数据类型转换规则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#05-%E5%AE%BD%E6%9D%BE%E6%AF%94%E8%BE%83%E4%B8%AD%E7%9A%84%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2"><span class="toc-text">05. 宽松比较中的隐式转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#06-%E8%BF%90%E7%AE%97%E4%B8%AD%E7%9A%84%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2"><span class="toc-text">06. 运算中的隐式转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#07-%E5%8E%9F%E5%9E%8B%E5%AF%B9%E8%B1%A1%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">07. 原型对象基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#08-%E5%8E%9F%E5%9E%8B%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6"><span class="toc-text">08. 原型对象进阶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#09-%E7%BB%A7%E6%89%BF"><span class="toc-text">09. 继承</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-instanceof"><span class="toc-text">10. instanceof</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-text">11. 作用域</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E9%97%AD%E5%8C%85"><span class="toc-text">12. 闭包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-this"><span class="toc-text">13. this</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-%E6%89%8B%E5%86%99-bind-%E6%96%B9%E6%B3%95"><span class="toc-text">14. 手写 bind 方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E7%B4%A2%E5%BC%95"><span class="toc-text">15. 获取元素索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-%E5%90%8C%E6%AD%A5%E5%92%8C%E5%BC%82%E6%AD%A5"><span class="toc-text">16. 同步和异步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-JavaScript-%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86"><span class="toc-text">17. JavaScript 运行原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-Promise"><span class="toc-text">18. Promise</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-async-await"><span class="toc-text">19. async await</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20-%E4%BC%98%E5%8C%96-DOM-%E6%93%8D%E4%BD%9C%E6%80%A7%E8%83%BD"><span class="toc-text">20. 优化 DOM 操作性能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-property-%E4%B8%8E-attribute"><span class="toc-text">21. property 与 attribute</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-%E9%80%9A%E7%94%A8%E7%9A%84%E7%BB%91%E5%AE%9A%E4%BA%8B%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-text">22. 通用的绑定事件的方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23-%E4%BA%8B%E4%BB%B6%E5%86%92%E6%B3%A1"><span class="toc-text">23. 事件冒泡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24-%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98"><span class="toc-text">24. 事件委托</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-Ajax"><span class="toc-text">25. Ajax</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#26-%E8%B7%A8%E5%9F%9F"><span class="toc-text">26. 跨域</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#27-%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8"><span class="toc-text">27. 本地存储</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#28-HTTP-%E5%8D%8F%E8%AE%AE"><span class="toc-text">28. HTTP 协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#29-restful-API"><span class="toc-text">29. restful API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#30-%E6%95%B0%E7%BB%84-splice%E3%80%81slice"><span class="toc-text">30. 数组 splice、slice</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#31-map-%E4%B8%8E-parseInt"><span class="toc-text">31. map 与 parseInt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-%E5%87%BD%E6%95%B0%E5%A3%B0%E6%98%8E%E4%B8%8E%E5%87%BD%E6%95%B0%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text">32. 函数声明与函数表达式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#33-%E6%89%8B%E5%86%99-trim-%E6%96%B9%E6%B3%95"><span class="toc-text">33. 手写 trim 方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#34-%E6%89%8B%E5%86%99-max-%E6%96%B9%E6%B3%95"><span class="toc-text">34. 手写 max 方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#35-%E6%8D%95%E8%8E%B7%E5%BC%82%E5%B8%B8"><span class="toc-text">35. 捕获异常</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#36-JSON-%E4%BB%8B%E7%BB%8D"><span class="toc-text">36. JSON 介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#37-%E8%8E%B7%E5%8F%96%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0"><span class="toc-text">37. 获取查询参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#38-%E6%8B%8D%E5%B9%B3%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84"><span class="toc-text">38. 拍平多维数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#39-%E6%95%B0%E7%BB%84%E5%8E%BB%E9%87%8D"><span class="toc-text">39. 数组去重</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#40-vue2-%E5%A3%B0%E6%98%8E%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-text">40. vue2 声明周期函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#41-vue2-%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%B0%83%E7%94%A8%E9%A1%BA%E5%BA%8F"><span class="toc-text">41. vue2 父子组件生命周期调用顺序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#42-vue2-keep-alive-%E7%BB%84%E4%BB%B6"><span class="toc-text">42. vue2 keep-alive 组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#43-vue2-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%8E%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82"><span class="toc-text">43. vue2 生命周期与异步请求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#44-Vue2-v-if-vs-v-show"><span class="toc-text">44. Vue2 v-if vs v-show</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#45-v-for-key"><span class="toc-text">45. v-for key</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#46-Vue2-%E7%BB%84%E4%BB%B6%E9%80%9A%E8%AE%AF"><span class="toc-text">46. Vue2 组件通讯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#47-v-model-%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-text">47. v-model 的实现原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#48-%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3-MVVM"><span class="toc-text">48. 如何理解 MVVM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#49-computed-%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7"><span class="toc-text">49 computed 计算属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#50-vue-data-%E5%87%BD%E6%95%B0"><span class="toc-text">50. vue data 函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#51-vue2-%E6%8A%BD%E5%8F%96%E9%80%BB%E8%BE%91"><span class="toc-text">51. vue2 抽取逻辑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#52-vue2-%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6"><span class="toc-text">52. vue2 异步组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#53-vue-%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%8F%92%E6%A7%BD"><span class="toc-text">53. vue 作用域插槽</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#54-vuex-action-mutation"><span class="toc-text">54. vuex action mutation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#55-vue-router-%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%BC%8F"><span class="toc-text">55. vue router 路由模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#55-JavaScript-%E6%A8%A1%E6%8B%9F%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1"><span class="toc-text">55. JavaScript 模拟前端路由</span></a></li></ol></div></div></widget>




</div>


    </aside>
    <div class='l_main'>
      

      


<div class="bread-nav fs12"><div id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a><span class="sep"></span><a class="cap breadcrumb" href="/">文章</a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98/">前端面试题</a></div><div id="post-meta">发布于&nbsp;<time datetime="2023-05-12T13:19:17.248Z">2023-05-12</time></div></div>

<article class='md-text content post'>
<h1 class="article-title"><span>JavaScript面试题</span></h1>
<h2 id="01-变量赋值"><a href="#01-变量赋值" class="headerlink" title="01. 变量赋值"></a>01. 变量赋值</h2><p>JavaScript 中的基本数据类型包括字符串、数值、布尔值、undefined、Symbol。</p>
<p>JavaScript 中的引用数据类型包括对象、数组、函数、null。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> m = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">let</span> n = m;</span><br><span class="line">m = <span class="number">200</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(n); <span class="comment">// ?</span></span><br></pre></td></tr></table></figure>

<p>基本数据类型在进行变量赋值时采用的是复制值的方式，n &#x3D; m 其实就是将 m 变量的值 100 复制了一份给了变量 n，重新为 m 变量赋值时变量 n 不会受到影响，所以变量 n 的值依然是 100。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = &#123; <span class="attr">age</span>: <span class="number">20</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> p2 = p1;</span><br><span class="line">p2.<span class="property">age</span> = <span class="number">21</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="property">age</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> m = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">let</span> n = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">display</span>(<span class="params">m, n</span>) &#123;</span><br><span class="line">  m = <span class="number">100</span>;</span><br><span class="line">  n = <span class="number">200</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">display</span>(m, n);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(m); <span class="comment">// ?</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(n); <span class="comment">// ?</span></span><br></pre></td></tr></table></figure>

<p>复杂数据类型在进行变量赋值时采用的是复制地址的方式，p2 &#x3D; p1 其实就是将变量 p1 对应的对象引用地址复制了一份给了变量 p2，此时 p1 变量和 p2 变量同时指向了同一个对象，所以无论是使用 p1 更改 age 还是使用 p2 更改 age，双方都会受到影响。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> o1 = &#123;</span><br><span class="line">  <span class="attr">x</span>: <span class="number">100</span>,</span><br><span class="line">  <span class="attr">y</span>: <span class="number">200</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> o2 = o1;</span><br><span class="line"><span class="keyword">let</span> x = o1.<span class="property">x</span>;</span><br><span class="line">o2.<span class="property">x</span> = <span class="number">101</span>;</span><br><span class="line">x = <span class="number">102</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(o1.<span class="property">x</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p = &#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">person</span>(<span class="params">p</span>) &#123;</span><br><span class="line">  p.<span class="property">name</span> = <span class="string">&quot;李四&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">person</span>(p);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p.<span class="property">name</span>); <span class="comment">// ?</span></span><br></pre></td></tr></table></figure>

<p>在 JavaScript 中，var、let、const 有什么区别？</p>
<p><code>var</code>、<code>const</code>、<code>let</code> 是 JavaScript 中用于声明变量的关键字，它们之间的主要区别在于作用域和是否可重新赋值。</p>
<ol>
<li><p><code>var</code> 声明的变量具有函数作用域（function scope），这意味着它们在整个函数体内都可见。</p>
<p><code>var</code> 可以在任何时候重新赋值，也可以在声明之前使用（hoisted）。</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">testVar</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(foo); <span class="comment">// 输出 &quot;undefined&quot;，因为 var 变量会提升（hoisted）</span></span><br><span class="line">  <span class="keyword">var</span> foo = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(foo); <span class="comment">// 输出 &quot;Hello&quot;</span></span><br><span class="line">  foo = <span class="string">&quot;World&quot;</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(foo); <span class="comment">// 输出 &quot;World&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">testVar</span>();</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p><code>let</code> 声明的变量具有块级作用域（block scope），这意味着它们只在定义它们的代码块内可见。</p>
<p><code>let</code> 可以在任何时候重新赋值，但不能在声明之前使用。</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">testLet</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// console.log(bar); 在此时使用会报错，因为 let 变量不会提升</span></span><br><span class="line">  <span class="keyword">let</span> bar = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(bar); <span class="comment">// 输出 &quot;Hello&quot;</span></span><br><span class="line">  bar = <span class="string">&quot;World&quot;</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(bar); <span class="comment">// 输出 &quot;World&quot;</span></span><br><span class="line"></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">let</span> bar = <span class="string">&quot;Inside block&quot;</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(bar); <span class="comment">// 输出 &quot;Inside block&quot;，因为这是一个新的作用域</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(bar); <span class="comment">// 输出 &quot;World&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">testLet</span>();</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><code>const</code> 用于声明一个常量，它具有与 <code>let</code> 相同的块级作用域，但在声明时必须初始化，且之后不能重新赋值。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">testConst</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// console.log(baz); 在此时使用会报错，因为 const 变量不会提升</span></span><br><span class="line">  <span class="keyword">const</span> baz = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(baz); <span class="comment">// 输出 &quot;Hello&quot;</span></span><br><span class="line">  <span class="comment">// baz = &quot;World&quot;; // 如果尝试重新赋值，将会导致错误</span></span><br><span class="line"></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">const</span> baz = <span class="string">&quot;Inside block&quot;</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(baz); <span class="comment">// 输出 &quot;Inside block&quot;，因为这是一个新的作用域</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(baz); <span class="comment">// 输出 &quot;Hello&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">testConst</span>();</span><br></pre></td></tr></table></figure>

<p>在现代 JavaScript 开发中，一般建议尽量使用 <code>let</code> 和 <code>const</code>，以避免因 <code>var</code> 变量提升和函数作用域可能导致的意外行为。</p>
<h2 id="02-typeof-运算符"><a href="#02-typeof-运算符" class="headerlink" title="02. typeof 运算符"></a>02. typeof 运算符</h2><p>typeof 运算符可以识别所有的基本数据类型、函数、可以识别是否是引用数据类型。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;Hello JavaScript&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> m = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">let</span> isMarry = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">let</span> unique = <span class="title class_">Symbol</span>(<span class="string">&quot;unique&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> n = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> empty = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> str); <span class="comment">// &quot;string&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> m); <span class="comment">// &quot;number&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> isMarry); <span class="comment">// &quot;boolean&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> unique); <span class="comment">// &quot;symbol&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> n); <span class="comment">// &quot;undefined&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> fn); <span class="comment">// &quot;function&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> arr); <span class="comment">// &quot;object&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> obj); <span class="comment">// &quot;object&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="literal">null</span>); <span class="comment">// &quot;object&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="03-深拷贝"><a href="#03-深拷贝" class="headerlink" title="03. 深拷贝"></a>03. 深拷贝</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">deepClone</span>(<span class="params">target</span>) &#123;</span><br><span class="line">  <span class="comment">// 如果要拷贝的数据不是引用数据类型或要拷贝的数据为 null</span></span><br><span class="line">  <span class="comment">// 表示不需要深拷贝, 直接返回该数据即可</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> target !== <span class="string">&quot;object&quot;</span> || target === <span class="literal">null</span>) <span class="keyword">return</span> target;</span><br><span class="line">  <span class="comment">// 创建新的变量用于保存拷贝结果 区分要拷贝的数据是数组还是对象</span></span><br><span class="line">  <span class="keyword">let</span> result = target <span class="keyword">instanceof</span> <span class="title class_">Array</span> ? [] : &#123;&#125;;</span><br><span class="line">  <span class="comment">// 遍历要拷贝的数据</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> target) &#123;</span><br><span class="line">    <span class="comment">// 拷贝时排除原型对象中的属性</span></span><br><span class="line">    <span class="keyword">if</span> (target.<span class="title function_">hasOwnProperty</span>(key)) &#123;</span><br><span class="line">      <span class="comment">// 递归拷贝</span></span><br><span class="line">      result[key] = <span class="title function_">deepClone</span>(target[key]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 返回拷贝结果</span></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clone</span>(<span class="params">target</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> target !== <span class="string">&quot;object&quot;</span> || target === <span class="literal">null</span>) <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">p</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="title function_">deepClone</span>(obj1);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj1 === obj2);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj2);</span><br><span class="line">obj2.<span class="property">p</span>.<span class="property">name</span> = <span class="string">&quot;李四&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj1.<span class="property">p</span>.<span class="property">name</span>);</span><br></pre></td></tr></table></figure>

<p>编写一个方法用于比较两个对象是否深度相等。</p>
<p>在 JavaScript 中，可以使用递归方法来实现深度比较两个对象是否相等。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">isEqual</span>(<span class="params">obj1, obj2</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (obj1 === obj2) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    <span class="keyword">typeof</span> obj1 !== <span class="string">&quot;object&quot;</span> ||</span><br><span class="line">    <span class="keyword">typeof</span> obj2 !== <span class="string">&quot;object&quot;</span> ||</span><br><span class="line">    obj1 === <span class="literal">null</span> ||</span><br><span class="line">    obj2 === <span class="literal">null</span></span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> keys1 = <span class="title class_">Object</span>.<span class="title function_">keys</span>(obj1);</span><br><span class="line">  <span class="keyword">const</span> keys2 = <span class="title class_">Object</span>.<span class="title function_">keys</span>(obj2);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (keys1.<span class="property">length</span> !== keys2.<span class="property">length</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">of</span> keys1) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!keys2.<span class="title function_">includes</span>(key)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">isEqual</span>(obj1[key], obj2[key])) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个 <code>isEqual</code> 方法首先比较两个对象的引用是否相等，如果相等则返回 true。然后，检查两个对象是否都是对象类型，如果不是，则返回 false。接下来，比较两个对象的键的数量，如果不相等，则返回 false。最后，使用递归方法逐个比较键值，如果存在不相等的键值，则返回 false。如果所有键值都相等，则返回 true。</p>
<h2 id="04-数据类型转换规则"><a href="#04-数据类型转换规则" class="headerlink" title="04. 数据类型转换规则"></a>04. 数据类型转换规则</h2><p>① 其他类型的值转换为字符串</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">String</span>(<span class="literal">null</span>); <span class="comment">// &quot;null&quot;</span></span><br><span class="line"><span class="title class_">String</span>(<span class="literal">undefined</span>); <span class="comment">// &quot;undefined&quot;</span></span><br><span class="line"><span class="title class_">String</span>(<span class="literal">true</span>); <span class="comment">// &quot;true&quot;</span></span><br><span class="line"><span class="title class_">String</span>(<span class="literal">false</span>); <span class="comment">// &quot;false&quot;</span></span><br><span class="line"><span class="title class_">String</span>(<span class="number">10</span>); <span class="comment">// &quot;10&quot;</span></span><br><span class="line"><span class="comment">// 数组转为字符串是将数组中的所有元素按照 &quot;,&quot; 连接起来</span></span><br><span class="line"><span class="comment">// 相当于调用数组的 Array.prototype.join(&quot;,&quot;) 方法</span></span><br><span class="line"><span class="comment">// 如 [1, 2, 3] 转为 &quot;1,2,3&quot;</span></span><br><span class="line"><span class="comment">// 空数组 [] 转为空字符串</span></span><br><span class="line"><span class="comment">// 数组中的 null 或 undefined, 会被当做空字符串处理</span></span><br><span class="line"><span class="title class_">String</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]); <span class="comment">// &quot;1,2,3&quot;</span></span><br><span class="line"><span class="title class_">String</span>([]); <span class="comment">// &quot;&quot;</span></span><br><span class="line"><span class="title class_">String</span>([<span class="literal">null</span>]); <span class="comment">// &quot;&quot;</span></span><br><span class="line"><span class="title class_">String</span>([<span class="number">1</span>, <span class="literal">undefined</span>, <span class="number">3</span>]); <span class="comment">// &quot;1,,3&quot;</span></span><br><span class="line"><span class="comment">// 普通对象转为字符串相当于直接使用 Object.prototype.toString() 方法</span></span><br><span class="line"><span class="title class_">String</span>(&#123;&#125;); <span class="comment">// &quot;[object Object]&quot;</span></span><br></pre></td></tr></table></figure>

<p>② 其他类型的值转换为数值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Number</span>(<span class="literal">null</span>); <span class="comment">// 0</span></span><br><span class="line"><span class="title class_">Number</span>(<span class="literal">undefined</span>); <span class="comment">// NaN</span></span><br><span class="line"><span class="title class_">Number</span>(<span class="string">&quot;10&quot;</span>); <span class="comment">// 10</span></span><br><span class="line"><span class="title class_">Number</span>(<span class="string">&quot;10px&quot;</span>); <span class="comment">// NaN</span></span><br><span class="line"><span class="title class_">Number</span>(<span class="string">&quot;&quot;</span>); <span class="comment">// 0</span></span><br><span class="line"><span class="title class_">Number</span>(<span class="literal">true</span>); <span class="comment">// 1</span></span><br><span class="line"><span class="title class_">Number</span>(<span class="literal">false</span>); <span class="comment">// 0</span></span><br><span class="line"><span class="comment">// 数组会先被转换为原始类型, 然后再将转换后的原始类型转换为数值类型</span></span><br><span class="line"><span class="title class_">Number</span>([]); <span class="comment">// 0</span></span><br><span class="line"><span class="title class_">Number</span>([<span class="string">&quot;10&quot;</span>]); <span class="comment">// 10</span></span><br><span class="line"><span class="title class_">Number</span>([<span class="string">&quot;10&quot;</span>, <span class="string">&quot;20&quot;</span>]); <span class="comment">// NaN</span></span><br><span class="line"><span class="title class_">Number</span>(&#123;&#125;); <span class="comment">// NaN</span></span><br></pre></td></tr></table></figure>

<p>③ 其他类型转换为布尔值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Boolean</span>(<span class="literal">null</span>); <span class="comment">// false</span></span><br><span class="line"><span class="title class_">Boolean</span>(<span class="literal">undefined</span>); <span class="comment">// false</span></span><br><span class="line"><span class="title class_">Boolean</span>(<span class="string">&quot;&quot;</span>); <span class="comment">// false</span></span><br><span class="line"><span class="title class_">Boolean</span>(<span class="title class_">NaN</span>); <span class="comment">// false</span></span><br><span class="line"><span class="title class_">Boolean</span>(<span class="number">0</span>); <span class="comment">// false</span></span><br><span class="line"><span class="title class_">Boolean</span>([]); <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Boolean</span>(&#123;&#125;); <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Boolean</span>(<span class="title class_">Infinity</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>④ 对象、数组转换为原始类型</p>
<p>当对象类型需要被转为原始类型时，它会先查找对象的 valueOf 方法，如果 valueOf 方法返回原始类型的值，就使用这个值作为转换结果。</p>
<p>如果 valueOf 方法返回的不是原始类型的值，尝试调用对象的 toString 方法，使用该方法的返回值作为转换结果。</p>
<p>valueOf 方法用于返回对象的原始类型，一般由系统自动调用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建字符串对象</span></span><br><span class="line"><span class="keyword">let</span> strObject = <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line"><span class="comment">// 输出字符串对象</span></span><br><span class="line">strObject; <span class="comment">// String &#123; 0: &quot;H&quot;, 1: &quot;e&quot;, 2: &quot;l&quot;, 3: &quot;l&quot;, 4: &quot;o&quot; &#125;</span></span><br><span class="line"><span class="comment">// 输出它字符串对象的类型</span></span><br><span class="line"><span class="keyword">typeof</span> strObject; <span class="comment">// &quot;object&quot;</span></span><br><span class="line"><span class="comment">// 获取字符串对象 strObject 的原始值</span></span><br><span class="line">strObject.<span class="title function_">valueOf</span>(); <span class="comment">// &quot;Hello&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> object = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> array = [];</span><br><span class="line"></span><br><span class="line">object.<span class="title function_">valueOf</span>(); <span class="comment">// &#123;&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(array.<span class="title function_">valueOf</span>()); <span class="comment">// []</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> object = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> array = [];</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">valueOf</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">100</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(object.<span class="title function_">valueOf</span>()); <span class="comment">// 100</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(array.<span class="title function_">valueOf</span>()); <span class="comment">// 100</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将数组转换为数值类型</span></span><br><span class="line"><span class="comment">// 系统会先调用数组下的 valueOf 方法, 但是当前 valueOf 方法返回的就是数组, 所以系统去调用 toString 方法</span></span><br><span class="line"><span class="comment">// toString 方法调用之后返回了一个空字符串, 将空字符串转换为数值会得到 0</span></span><br><span class="line"><span class="title class_">Number</span>([]);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在以下运算式中由于 + 号两边都不是数值, 所以要进行字符串连接操作</span></span><br><span class="line"><span class="comment">// 系统会先调用对象下的 valueOf 方法, 但是当前 valueOf 方法返回的就是对象, 所以系统去调用 toString 方法</span></span><br><span class="line"><span class="comment">// toString 方法调用后返回了 &#x27;[object Object]&#x27;, 所以最终连接的结果就是 &#x27;[object Object][object Object]&#x27;</span></span><br><span class="line">(&#123;&#125;) + &#123;&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="05-宽松比较中的隐式转换"><a href="#05-宽松比较中的隐式转换" class="headerlink" title="05. 宽松比较中的隐式转换"></a>05. 宽松比较中的隐式转换</h2><p>在 JavaScript 中宽松比较会发生隐式类型转换，严格比较不会发生隐式类型转换。</p>
<p>① 布尔类型和其他类型的相等比较</p>
<p>布尔类型的值在参数比较时值会被转换为数值类型，true 转换为 1，false 转换为 0</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">false</span> == <span class="number">0</span>; <span class="comment">// true</span></span><br><span class="line"><span class="literal">true</span> == <span class="number">1</span>; <span class="comment">// true</span></span><br><span class="line"><span class="literal">true</span> == <span class="number">2</span>; <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> x = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">if</span> (x == <span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x); <span class="comment">// ? 是否会被输出</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>② 数值类型和字符串类型的相等比较</p>
<p>当数值类型和字符串类型做相等比较时，字符串类型会被转换为数值类型。</p>
<p>如果字符串为数值字符串，则将其转换为对应的数值，如果是空字符串转换为 0，其他一律转换为 NaN。</p>
<p>NaN 和任何值比较都不相等，包括它自己。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> == <span class="string">&quot;&quot;</span>; <span class="comment">// true</span></span><br><span class="line"><span class="number">1</span> == <span class="string">&quot;1&quot;</span>; <span class="comment">// true</span></span><br><span class="line"><span class="literal">true</span> == <span class="string">&quot;1&quot;</span>; <span class="comment">// true</span></span><br><span class="line"><span class="literal">false</span> == <span class="string">&quot;0&quot;</span>; <span class="comment">// true</span></span><br><span class="line"><span class="literal">false</span> == <span class="string">&quot;&quot;</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>③ 对象类型和原始类型的相等比较</p>
<p>当对象类型和原始类型做相等比较时，对象类型要被转换为原始类型。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;[object Object]&quot;</span> == &#123;&#125;; <span class="comment">// true</span></span><br><span class="line"><span class="string">&quot;1,2,3&quot;</span> == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在以下比较中, 数组需要被转换为原始类型, 系统先调用 valueOf 方法, 但返回值不是原始值</span></span><br><span class="line"><span class="comment">// 系统继续调用 toString 方法, 得到 &quot;2&quot;</span></span><br><span class="line"><span class="comment">// &quot;2&quot; == 2 比较, 字符串会被转换为数值 2, 所以 2 == 2 比较, 得到的结果是 true</span></span><br><span class="line">[<span class="number">2</span>] == <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="literal">null</span>] == <span class="number">0</span> <span class="comment">// true</span></span><br><span class="line">[<span class="literal">undefined</span>] == <span class="number">0</span> <span class="comment">// true</span></span><br><span class="line">[] == <span class="number">0</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &quot;&quot; == false</span></span><br><span class="line"><span class="comment">// &quot;&quot; == 0</span></span><br><span class="line"><span class="comment">// 0 == 0</span></span><br><span class="line">[] == ![]; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &quot;[object Object]&quot; == false</span></span><br><span class="line"><span class="comment">// &quot;[object Object]&quot; == 0</span></span><br><span class="line"><span class="comment">// NaN == 0</span></span><br><span class="line">&#123;&#125; == !&#123;&#125; <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当两个操作数都是对象时，JavaScript 会比较其内存中的引用地址</span></span><br><span class="line">[] == []</span><br><span class="line">&#123;&#125; == &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>④ null、undefined 和其他类型的比较</p>
<p>null 和 undefined 宽松相等的结果为 true，null 和 null 相等，undefined 和 undefined 相等。</p>
<p>null 和 undefined 和其他值比较时都不相等。</p>
<p>null 和 undefined 都是假值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">null</span> == <span class="literal">undefined</span>; <span class="comment">// true</span></span><br><span class="line"><span class="literal">null</span> == <span class="literal">false</span>; <span class="comment">// false</span></span><br><span class="line"><span class="literal">undefined</span> == <span class="literal">false</span>; <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>总结：在日常工作中进行相等比较时一律使用严格比较避免隐式类型转换产生的不可预知问题。</p>
<p>只有一种情况除外，当我们要判断对象中是否存在某一个属性时，可以使用宽松比较。</p>
<p>如果一个对象中的属性的值是 null 或是 undefined，我们都认为这个属性是不存在的。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> object = &#123;</span><br><span class="line">  <span class="attr">x</span>: <span class="number">100</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 因为 x 无论是 null 还是 undefined, 和 null 进行比较时都会相等</span></span><br><span class="line"><span class="keyword">if</span> (object.<span class="property">x</span> == <span class="literal">null</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;不存在&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;存在&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="06-运算中的隐式转换"><a href="#06-运算中的隐式转换" class="headerlink" title="06. 运算中的隐式转换"></a>06. 运算中的隐式转换</h2><p>在使用 + - * &#x2F; 进行运算时，数据类型会发生隐式类型转换。</p>
<p>+ 号两边只要有一个运算数是字符串类型，其他运算数都会被转换成字符串类型。</p>
<p>除了 + 号以外的其他运算符，比如 - * &#x2F; 等都会将运算数转换为数值类型。</p>
<p>+ 作为正号使用会将运算数转换为数值类型。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;11&quot;</span> + <span class="number">11</span>;</span><br><span class="line"><span class="string">&quot;11&quot;</span> - <span class="number">11</span>;</span><br><span class="line"><span class="number">11</span> + +<span class="string">&quot;11&quot;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="07-原型对象基本使用"><a href="#07-原型对象基本使用" class="headerlink" title="07. 原型对象基本使用"></a>07. 原型对象基本使用</h2><p>在 JavaScript 中每一个构造函数都会配备一个名字叫做 prototype 的对象，我们称它为原型对象。</p>
<p>原型对象的作用是为了在实例对象之间进行属性共享。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Person 构造函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="comment">// Person 构造函数的原型对象</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Person 构造函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在 Person 构造函数的原型对象中添加 sayHello 方法</span></span><br><span class="line"><span class="comment">// 所有通过 Person 构造函数创建出来的实例对象都可以调用该方法</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHello</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">`Hello, 我是<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 p1 实例</span></span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line"><span class="comment">// 创建 p2 实例</span></span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;李四&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 验证 p1 实例是否可以调用 sayHello 方法</span></span><br><span class="line">p1.<span class="title function_">sayHello</span>();</span><br><span class="line"><span class="comment">// 验证 p2 实例是否可以调用 sayHello 方法</span></span><br><span class="line">p2.<span class="title function_">sayHello</span>();</span><br><span class="line"><span class="comment">// 验证 p1 和 p2 调用的是否是同一个 sayHello 方法</span></span><br><span class="line"><span class="title function_">alert</span>(p1.<span class="property">sayHello</span> === p2.<span class="property">sayHello</span>);</span><br></pre></td></tr></table></figure>

<img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="./assets/03.png" align="left" width="50%"/>

<p>实例对象在查找属性时，先在自身进行查找，自身如果找不到再去构造函数的原型对象中查找。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p1.<span class="property">sayHello</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">`Hello, 我是<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>, 我是实例对象自身身上的 sayHello 方法`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">p1.<span class="title function_">sayHello</span>();</span><br><span class="line">p2.<span class="title function_">sayHello</span>();</span><br></pre></td></tr></table></figure>

<p>在实例对象身上有一个属性叫做 __proto__，它指向了实例的构造函数的原型对象，实例对象在查找属性时就是通过它找到的原型对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(p1.<span class="property">__proto__</span> === <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>);</span><br></pre></td></tr></table></figure>

<p>__proto__ 被称之为隐式原型对象，实例会自动通过它去原型对象中查找，开发者不需要显式的去调用它。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(p2.<span class="property">sayHello</span> === p2.<span class="property">__proto__</span>.<span class="property">sayHello</span>);</span><br></pre></td></tr></table></figure>

<p>在每一个原型对象中都会有一个名字叫做 constructor 的属性，该属性指向了构造函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> === <span class="title class_">Person</span>);</span><br><span class="line"><span class="title function_">alert</span>(p1.<span class="property">constructor</span> === <span class="title class_">Person</span>);</span><br></pre></td></tr></table></figure>

<h2 id="08-原型对象进阶"><a href="#08-原型对象进阶" class="headerlink" title="08. 原型对象进阶"></a>08. 原型对象进阶</h2><p>Person.prototype 对象是 Object 构造函数的实例。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以下代码不需要开发者编写</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br></pre></td></tr></table></figure>

<img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="./assets/04.png" align="left" width="85%"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 此处 p1 调用的 hasOwnProperty 方法以及 toString 方法均来自 Object 构造函数的原型对象</span></span><br><span class="line"><span class="title function_">alert</span>(p1.<span class="title function_">hasOwnProperty</span>(<span class="string">&quot;name&quot;</span>));</span><br><span class="line"><span class="title function_">alert</span>(p1.<span class="title function_">toString</span>());</span><br></pre></td></tr></table></figure>

<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">p1.<span class="property">__proto__</span> === <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>; <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>; <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === <span class="literal">null</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="./assets/05.png" align="left" width="85%"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property">__proto__</span> === <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>; <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>; <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === <span class="literal">null</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h2 id="09-继承"><a href="#09-继承" class="headerlink" title="09. 继承"></a>09. 继承</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Student</span>(<span class="params">name, number</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">number</span> = number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> s1 = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">01</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Student</span>(<span class="params">name, number</span>) &#123;</span><br><span class="line">  <span class="comment">// 继承父类实例属性</span></span><br><span class="line">  <span class="title class_">Person</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 继承父类原型属性</span></span><br><span class="line"><span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> = <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> s1 = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">01</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES6 语法糖</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, 我是<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(name);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">number</span> = <span class="built_in">number</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">sayNumber</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`我是<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>, 我的学号是<span class="subst">$&#123;<span class="variable language_">this</span>.<span class="built_in">number</span>&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">Person</span>); <span class="comment">// &quot;function&quot;</span></span><br><span class="line"><span class="keyword">const</span> tom = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;Tom&quot;</span>, <span class="number">1</span>);</span><br><span class="line">tom.<span class="title function_">sayHello</span>();</span><br><span class="line">tom.<span class="title function_">sayNumber</span>();</span><br></pre></td></tr></table></figure>

<h2 id="10-instanceof"><a href="#10-instanceof" class="headerlink" title="10. instanceof"></a>10. instanceof</h2><p>instanceof 运算符用于检查对象的类型，它返回一个布尔值，如果为真则表示该对象是特定类的实例，如果为假则不是。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tom <span class="keyword">instanceof</span> <span class="title class_">Student</span>; <span class="comment">// true</span></span><br><span class="line">tom <span class="keyword">instanceof</span> <span class="title class_">Person</span>; <span class="comment">// true</span></span><br><span class="line">tom <span class="keyword">instanceof</span> <span class="title class_">Object</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[] <span class="keyword">instanceof</span> <span class="title class_">Array</span>   <span class="comment">// true</span></span><br><span class="line">[] <span class="keyword">instanceof</span> <span class="title class_">Object</span>  <span class="comment">// true</span></span><br><span class="line">&#123;&#125; <span class="keyword">instanceof</span> <span class="title class_">Object</span>  <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h2 id="11-作用域"><a href="#11-作用域" class="headerlink" title="11. 作用域"></a>11. 作用域</h2><p>作用域是指变量和函数的可访问范围。</p>
<p>JavaScript 中有全局作用域、局部作用域和块级作用域。</p>
<p>(1) 全局作用域</p>
<p>在全局作用域中声明的变量和函数可以在代码中的任何位置被访问。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全局作用域中声明变量</span></span><br><span class="line"><span class="keyword">var</span> globalVariable = <span class="string">&quot;global variable&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局作用域中声明函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">globalFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;global function&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在函数中访问全局变量和函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">myFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(globalVariable);</span><br><span class="line">  <span class="title function_">globalFunction</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出：global variable 和 global function</span></span><br><span class="line"><span class="title function_">myFunction</span>();</span><br></pre></td></tr></table></figure>

<p>(2) 局部作用域</p>
<p>局部作用域是指在函数内部声明的变量和函数，只能在函数内部访问。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 在函数内部声明局部变量</span></span><br><span class="line">  <span class="keyword">var</span> localVariable = <span class="string">&quot;local variable&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 在函数内部声明局部函数</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">localFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;local function&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(localVariable);</span><br><span class="line">  <span class="title function_">localFunction</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">myFunction</span>(); <span class="comment">// 输出：local variable 和 local function</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(localVariable); <span class="comment">// 报错：localVariable is not defined</span></span><br></pre></td></tr></table></figure>

<p>(3) 块级作用域</p>
<p>块级作用域是指在 if、for、while 等语句中产生的作用域，在其中声明的变量和函数只在该代码块内部有效。</p>
<p>在 ES6 中使用关键字 let 和 const 声明的变量具有块级作用域。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 let 和 const 声明变量具有块级作用域</span></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> x = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">const</span> y = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x); <span class="comment">// 报错：x is not defined</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(y); <span class="comment">// 报错：y is not defined</span></span><br></pre></td></tr></table></figure>

<img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="./assets/06.png" align="left" width="70%"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">print</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">200</span>;</span><br><span class="line">  <span class="title function_">fn</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">print</span>(fn);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= <span class="number">3</span>; i++) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= <span class="number">3</span>; i++) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">12</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">13</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fn</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">12</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  a = <span class="number">13</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fn</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">a = <span class="number">12</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  a = <span class="number">13</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fn</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!foo) &#123;</span><br><span class="line">    <span class="keyword">var</span> foo = <span class="number">10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(foo);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">bar</span>();</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 不管条件是否成立都会进行变量提升 var foo = undefined;</span></span><br><span class="line">  <span class="comment">// if (!undefined) =&gt; 将 undefined 转换为布尔值再取反 !false =&gt; true</span></span><br><span class="line">  <span class="keyword">if</span> (!foo) &#123;</span><br><span class="line">    <span class="keyword">var</span> foo = <span class="number">10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(foo);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">bar</span>();</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>,</span><br><span class="line">  b = <span class="number">11</span>,</span><br><span class="line">  c = <span class="number">13</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params">a</span>) &#123;</span><br><span class="line">  a = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">2</span>;</span><br><span class="line">  c = <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!(<span class="string">&quot;a&quot;</span> <span class="keyword">in</span> <span class="variable language_">window</span>)) &#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">b</span>(<span class="params">x, y, a</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  <span class="comment">// 在 JS 非严格模式下实参集合与形参变量存在映射关系, 严格模式下该关系比切断了</span></span><br><span class="line">  <span class="variable language_">arguments</span>[<span class="number">2</span>] = <span class="number">10</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a = <span class="title function_">b</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">(<span class="keyword">function</span> (<span class="params">foo</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(foo);</span><br><span class="line">  <span class="keyword">var</span> foo = foo || <span class="string">&quot;world&quot;</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(foo);</span><br><span class="line">&#125;)(foo);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo);</span><br></pre></td></tr></table></figure>

<h2 id="12-闭包"><a href="#12-闭包" class="headerlink" title="12. 闭包"></a>12. 闭包</h2><p>闭包就是一个函数，一个引用了上级作用域链中的变量的函数，即使外部函数已不存在，也可以通过作用域链访问到外部函数中声明的变量。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> testVar = <span class="string">&quot;test&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(testVar);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> inner = <span class="title function_">outer</span>();</span><br><span class="line"><span class="title function_">inner</span>();</span><br></pre></td></tr></table></figure>

<p>使用闭包实现模块化开发</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="variable language_">module</span> = (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> privateVar = <span class="string">&quot;这个变量是私有的&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">privateFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;私有函数&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">publicVar</span>: <span class="string">&quot;这个变量是公开的&quot;</span>,</span><br><span class="line">    <span class="attr">publicFunction</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;公开函数&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">module</span>.<span class="property">publicVar</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="title function_">publicFunction</span>();</span><br></pre></td></tr></table></figure>

<p>使用闭包实现计数器功能</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    count++;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(count);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> countFunc = <span class="title function_">counter</span>();</span><br><span class="line"><span class="title function_">countFunc</span>(); <span class="comment">// 1</span></span><br><span class="line"><span class="title function_">countFunc</span>(); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>

<p>使用闭包实现缓存功能</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">cache</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> results = &#123;&#125;;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">key, val</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (results[key]) &#123;</span><br><span class="line">      <span class="keyword">return</span> results[key];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      results[key] = val;</span><br><span class="line">      <span class="keyword">return</span> val;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> getResults = <span class="title function_">cache</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getResults</span>(<span class="string">&quot;a&quot;</span>, <span class="number">1</span>)); <span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getResults</span>(<span class="string">&quot;a&quot;</span>, <span class="number">2</span>)); <span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getResults</span>(<span class="string">&quot;b&quot;</span>, <span class="number">2</span>)); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>

<p>使用闭包实现一次性函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">singleUse</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> isUsed = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isUsed) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;执行一次&quot;</span>);</span><br><span class="line">      isUsed = <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;无法执行！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> useFunc = <span class="title function_">singleUse</span>();</span><br><span class="line"><span class="title function_">useFunc</span>(); <span class="comment">// 执行一次</span></span><br><span class="line"><span class="title function_">useFunc</span>(); <span class="comment">// 无法执行！</span></span><br></pre></td></tr></table></figure>

<p>面试题</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> n = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> n = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">b</span>(<span class="params"></span>) &#123;</span><br><span class="line">    n++;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(n);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">b</span>();</span><br><span class="line">  <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c = <span class="title function_">a</span>();</span><br><span class="line"><span class="title function_">c</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(n);</span><br></pre></td></tr></table></figure>

<h2 id="13-this"><a href="#13-this" class="headerlink" title="13. this"></a>13. this</h2><p>JavaScript 中的 this 是一个指向当前执行环境的关键字，用来访问当前执行环境的上下文。</p>
<p>this 具体指向的对象要取决于当前调用方式。</p>
<p>(1) 默认绑定：函数调用时没有明确指定 this 的指向，或者使用的是独立的函数调用方式时，this 会绑定到全局对象上。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">test</span>(); <span class="comment">// Window (浏览器) / global (Node.js)</span></span><br></pre></td></tr></table></figure>

<p>(2) 隐式绑定：函数作为对象的属性调用时，this 会绑定到该对象。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line">  <span class="title function_">sayName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">obj.<span class="title function_">sayName</span>(); <span class="comment">// Alice</span></span><br></pre></td></tr></table></figure>

<p>(3) 显式绑定：使用 apply、call、bind 等函数显式调用时，可以指定 this 的指向。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>!`</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> person1 = &#123; <span class="attr">name</span>: <span class="string">&quot;Alice&quot;</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> person2 = &#123; <span class="attr">name</span>: <span class="string">&quot;Bob&quot;</span> &#125;;</span><br><span class="line">greet.<span class="title function_">call</span>(person1); <span class="comment">// Hello, Alice!</span></span><br><span class="line">greet.<span class="title function_">apply</span>(person2); <span class="comment">// Hello, Bob!</span></span><br><span class="line"><span class="keyword">const</span> boundGreet = greet.<span class="title function_">bind</span>(person1); <span class="comment">// bind 方法返回一个新函数</span></span><br><span class="line"><span class="title function_">boundGreet</span>(); <span class="comment">// Hello, Alice!</span></span><br></pre></td></tr></table></figure>

<p>(4) new 绑定：使用 new 关键字创建对象时，this 会绑定到新创建的对象上。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> person = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Alice&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>); <span class="comment">// Alice</span></span><br></pre></td></tr></table></figure>

<p>(5) 箭头函数：箭头函数没有自己的 this 绑定，会继承上一层作用域中的 this。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line">  <span class="attr">logMyName</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">obj.<span class="title function_">logMyName</span>(); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

<p>需要注意的是，箭头函数中的 this 不可以被显式地绑定或修改，因为箭头函数根本没有自己的 this。</p>
<h2 id="14-手写-bind-方法"><a href="#14-手写-bind-方法" class="headerlink" title="14. 手写 bind 方法"></a>14. 手写 bind 方法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个自定义的bind函数</span></span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myBind</span> = <span class="keyword">function</span> (<span class="params">context</span>) &#123;</span><br><span class="line">  <span class="comment">// 保存调用 myBind() 函数的函数对象</span></span><br><span class="line">  <span class="keyword">var</span> fn = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="comment">// 获取 myBind() 函数调用时传入的参数，不包括第一个参数（即需要绑定的 this 值或上下文对象）</span></span><br><span class="line">  <span class="keyword">var</span> args = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="comment">// 返回一个新函数</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 获取新函数调用时的参数</span></span><br><span class="line">    <span class="keyword">var</span> newArgs = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>);</span><br><span class="line">    <span class="comment">// 将新函数的参数和调用myBind()函数时传入的参数合并</span></span><br><span class="line">    <span class="keyword">var</span> allArgs = args.<span class="title function_">concat</span>(newArgs);</span><br><span class="line">    <span class="comment">// 返回调用原函数时的结果</span></span><br><span class="line">    <span class="keyword">return</span> fn.<span class="title function_">apply</span>(context, allArgs);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  上述代码首先在 Function.prototype 上添加了一个 myBind 方法，以实现自定义的 bind 方法。</span></span><br><span class="line"><span class="comment">  当我们使用 myBind() 函数的时候，需要传入一个上下文对象（即需要绑定的 this 值），</span></span><br><span class="line"><span class="comment">  以及可以传入一系列参数，稍后会与新函数的参数合并。在myBind()函数中，先将调用myBind()</span></span><br><span class="line"><span class="comment">  函数的原函数对象保存下来，并获取传入myBind()函数的参数数组，去除第一个参数（即上下文对象）。然后返回一个新函数，</span></span><br><span class="line"><span class="comment">  新函数的作用是将调用新函数的参数与新函数之前已经传入myBind()函数中的参数合并起来，再通过 apply() 方法来调用原函数，</span></span><br><span class="line"><span class="comment">  同时将上下文对象和所有参数传递给apply()方法，确保原函数能够正确的使用上下文和参数。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h2 id="15-获取元素索引"><a href="#15-获取元素索引" class="headerlink" title="15. 获取元素索引"></a>15. 获取元素索引</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;ul&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>a<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>b<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>c<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 获取 ul</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> ul = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;ul&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 获取 ul 的所有子元素</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> lis = ul.<span class="property">children</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 获取 ul 子元素的个数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> length = lis.<span class="property">length</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 遍历所有 li</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 为 li 添加点击事件</span></span></span><br><span class="line"><span class="language-javascript">    lis[i].<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 弹出 i 的值</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(i);</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解决办法一: 使用 let 关键字声明变量 i, 使其产生块级作用域</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解决办法二: 使用闭包使局部变量 i 不销毁</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">  (<span class="keyword">function</span> (<span class="params">i</span>) &#123;</span><br><span class="line">    <span class="comment">// 为 li 添加点击事件</span></span><br><span class="line">    lis[i].<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// 弹出 i 的值</span></span><br><span class="line">      <span class="title function_">alert</span>(i);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;)(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="16-同步和异步"><a href="#16-同步和异步" class="headerlink" title="16. 同步和异步"></a>16. 同步和异步</h2><p>在 JavaScript 中，同步和异步是指代码的执行方式。</p>
<p>同步代码会按照代码的书写顺序一行一行地执行，每行代码必须等待前一行代码执行完成后才能执行。</p>
<p>在同步代码中如果某个操作需要执行的时间较长，代码的执行会被阻塞，直到操作完成才能继续执行下一行代码。</p>
<p>异步代码则是在某些代码执行完成前(ajax 请求、定时器等) ，允许继续执行其他的代码。</p>
<p>异步代码的执行结果不会立即得到，异步操作完成后再通过回调函数获取执行结果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 同步代码</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Step 1&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Step 2&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Step 3&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Step 1</span><br><span class="line">Step 2</span><br><span class="line">Step 3</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 异步代码</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Step 1&quot;</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Step 2&quot;</span>);</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Step 3&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Step 1</span><br><span class="line">Step 3</span><br><span class="line">Step 2</span><br></pre></td></tr></table></figure>

<p>JavaScript 是单线的，这意味着它只能在一个时间点执行一个任务，无法同时执行多个任务。</p>
<p>如果某一个任务的执行需要耗费比较长的时间，那么程序将会被卡住，所以异步应运而生。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">4</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span>);</span><br></pre></td></tr></table></figure>

<h2 id="17-JavaScript-运行原理"><a href="#17-JavaScript-运行原理" class="headerlink" title="17. JavaScript 运行原理"></a>17. JavaScript 运行原理</h2><p>(1) JavaScript 为单线程语言</p>
<p>JavaScript 是单线程语言，这意味着 JavaScript 在同一个时间点只能执行一项任务，该项任务未完成之前其他任务需要等待。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始任务&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步任务</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sleep</span>(<span class="params">ms</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> start = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span><br><span class="line">  <span class="keyword">while</span> (<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() &lt; start + ms) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">sleep</span>(<span class="number">2000</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;同步任务完成&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;结束任务&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>(2) JavaScript 是如何实现异步的?</p>
<p>既然 JavaScript 是单线程的，那么它是怎样实现非阻塞(异步)的呢?</p>
<p>上面我们所说的 JavaScript 指的是 EcmaScript，所有 EcmaScript 代码都在同一个线程中执行，这个单线程通常我们称它为主线程。</p>
<p>但是当 JavaScript 在浏览器中运行时，它不仅包含了 EcmaScript 还包含了浏览器提供的 web API，比如 window、document、setInterval、fetch 等，浏览器提供的 web API 不能在主线程中执行，浏览器提供了另外的线程供它们执行。</p>
<p>所以更加准确的说，JavaScript 本身可以只在一个线程中执行，但是运行在浏览器中的 JavaScript 由多个线程共同的执行。</p>
<img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="./assets/07.png" align="left" width="65%"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Learning&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;About&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;The Event Loop&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">recursion</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">recursion</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">recursion</span>();</span><br></pre></td></tr></table></figure>

<img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="./assets/08.png" align="left" width="65%"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;🐹&quot;</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;🐹🐹&quot;</span>), <span class="number">0</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;🐹🐹🐹&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果调用堆栈为空并且任务队列中有待执行任务</span></span><br><span class="line"><span class="comment">// 依次将任务函数移动到调用堆栈中执行</span></span><br><span class="line"><span class="keyword">if</span> (callStack.<span class="property">isEmpty</span> &amp;&amp; taskQueue.<span class="property">length</span>) &#123;</span><br><span class="line">  <span class="title function_">eventLoop</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>(3) 宏任务与微任务</p>
<p>宏任务包括 script（整体代码），setTimeout, setInterval, setImmediate, requestAnimationFrame 等。</p>
<p>微任务包括 Promise.then&#x2F;catch&#x2F;finally、process.nextTick (NodeJS)、MutationObserver 等。</p>
<p>微任务执行的优先级高于宏任务，因为微任务都是 ECMAScript，宏任务都是 WebAPI。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始执行&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;setTimeout&quot;</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Promise 1&quot;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Promise 2&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;结束执行&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="18-Promise"><a href="#18-Promise" class="headerlink" title="18. Promise"></a>18. Promise</h2><p>JavaScript 的异步编程中最常见的问题之一就是回调地狱。</p>
<p>即一个异步操作完成后，需要执行另一个异步操作，而这个异步操作完成后又需要执行另一个异步操作，如此往复嵌套下去，代码变得十分冗长和难以维护。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">getData</span>(<span class="keyword">function</span> (<span class="params">data1</span>) &#123;</span><br><span class="line">  <span class="title function_">getMoreData</span>(data1, <span class="keyword">function</span> (<span class="params">data2</span>) &#123;</span><br><span class="line">    <span class="title function_">getMoreData</span>(data2, <span class="keyword">function</span> (<span class="params">data3</span>) &#123;</span><br><span class="line">      <span class="title function_">getMoreData</span>(data3, <span class="keyword">function</span> (<span class="params">data4</span>) &#123;</span><br><span class="line">        <span class="comment">// 继续嵌套下去...</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>为了避免回调地狱的问题，我们可以使用 Promise 来简化异步调用链。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">getData</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">data1</span>) =&gt;</span> <span class="title function_">getData</span>(data1))</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">data2</span>) =&gt;</span> <span class="title function_">getData</span>(data2))</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">data3</span>) =&gt;</span> <span class="title function_">getData</span>(data3))</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">data4</span>) =&gt;</span> <span class="title function_">getData</span>(data4))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;&#125;);</span><br></pre></td></tr></table></figure>

<p>Promise 解决回调地狱问题，它是一种用于异步编程的语法结构，可以使异步操作变得更加简单、易读和可维护。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getData</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">    xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, url);</span><br><span class="line">    xhr.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(xhr.<span class="property">response</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(<span class="title class_">Error</span>(<span class="string">&quot;请求失败，错误码：&quot;</span> + xhr.<span class="property">statusText</span>));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.<span class="property">onerror</span> = <span class="function">() =&gt;</span> <span class="title function_">reject</span>(<span class="title class_">Error</span>(<span class="string">&quot;网络请求错误&quot;</span>));</span><br><span class="line">    xhr.<span class="title function_">send</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getData</span>(<span class="string">&quot;https://jsonplaceholder.typicode.com/todos/1&quot;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;成功获取数据：&quot;</span>, response))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;获取数据失败：&quot;</span>, error));</span><br></pre></td></tr></table></figure>

<p>封装 loadImage 方法使用 Promise 加载图片。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">loadImage</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> img = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">    img.<span class="property">onload</span> = <span class="function">() =&gt;</span> <span class="title function_">resolve</span>(img);</span><br><span class="line">    img.<span class="property">onerror</span> = <span class="function">(<span class="params">err</span>) =&gt;</span> <span class="title function_">reject</span>(err);</span><br><span class="line">    img.<span class="property">src</span> = url;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// https://img95.699pic.com/photo/50046/5562.jpg_wh300.jpg</span></span><br><span class="line"><span class="comment">// https://img95.699pic.com/photo/50136/1351.jpg_wh300.jpg</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用方法</span></span><br><span class="line"><span class="title function_">loadImage</span>(<span class="string">&quot;https://img95.699pic.com/photo/50136/1351.jpg_wh300.jpg&quot;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">img</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 加载成功</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Image loaded&quot;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 加载失败</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>题一：Promise 的基本用法是什么？如何使用 Promise 处理异步操作？</p>
<p>答：Promise 是用于异步编程的一种解决方案，它可以更加优雅和可读地处理异步操作。Promise 有三种状态：Pending（等待态）、Resolved（成功态）和 Rejected（失败态）。在 Promise 构造函数中，可以传入一个 executor（执行器）函数，该函数接受两个参数，resolve 和 reject，代表 Promise 的成功和失败。在 executor 函数中，我们可以执行异步操作，并在操作成功或失败时调用相应的回调函数，例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &gt; <span class="number">0.5</span>) &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">reject</span>(<span class="string">&quot;failure&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Promise resolved: &quot;</span> + result);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Promise rejected: &quot;</span> + error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>题二：如何使用 Promise.all 处理多个异步操作？</p>
<p>答：Promise.all 方法接受一个 Promise 对象数组作为参数，将返回一个新的 Promise 对象。只有当数组中所有 Promise 对象都成功时，该 Promise 对象才会被 resolved；如果数组中任一个 Promise 对象失败，该 Promise 对象立即被 rejected，并返回失败的原因。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promises = [</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&quot;a&quot;</span>), <span class="number">1000</span>)),</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&quot;b&quot;</span>), <span class="number">2000</span>)),</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&quot;c&quot;</span>), <span class="number">3000</span>)),</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>(promises)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">results</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Promise.all resolved: &quot;</span> + results);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Promise.all rejected: &quot;</span> + error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>题三：如何使用 Promise.race 处理多个异步操作？</p>
<p>答：Promise.race 方法接受一个 Promise 对象数组作为参数，将返回一个新的 Promise 对象。只要有一个 Promise 对象率先改变状态，该 Promise 对象就会采用第一个率先改变状态的 Promise 对象的状态。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promises = [</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&quot;a&quot;</span>), <span class="number">1000</span>)),</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&quot;b&quot;</span>), <span class="number">2000</span>)),</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&quot;c&quot;</span>), <span class="number">3000</span>)),</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">race</span>(promises)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Promise.race resolved: &quot;</span> + result);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Promise.race rejected: &quot;</span> + error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>题四：说出输出结果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>();</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>();</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">4</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">4</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> promise2 = promise1.<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">fn</span> = (<span class="params"></span>) =&gt;</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"><span class="title function_">fn</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;start&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;start&quot;</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;time&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;resolve&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;end&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;timerStart&quot;</span>);</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;timerEnd&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">4</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;timer1&quot;</span>);</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;timer3&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;timer2&quot;</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;start&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;timer1&quot;</span>);</span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;promise&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;timer2&quot;</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;start&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;promise1&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> timer2 = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;timer2&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> timer1 = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;timer1&quot;</span>);</span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;promise2&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;start&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> promise2 = promise1.<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;error!!!&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;promise1&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;promise2&quot;</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;promise1&quot;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;promise2&quot;</span>);</span><br><span class="line">&#125;, <span class="number">2000</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;success1&quot;</span>);</span><br><span class="line">  <span class="title function_">reject</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;success2&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">promise</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;then: &quot;</span>, res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;catch: &quot;</span>, err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">reject</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;success2&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">promise</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;then1: &quot;</span>, res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;then2: &quot;</span>, res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;catch: &quot;</span>, err);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;then3: &quot;</span>, res);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 透传</span></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">1</span>).<span class="title function_">then</span>(<span class="number">2</span>).<span class="title function_">then</span>(<span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">3</span>)).<span class="title function_">then</span>(<span class="variable language_">console</span>.<span class="property">log</span>);</span><br></pre></td></tr></table></figure>

<h2 id="19-async-await"><a href="#19-async-await" class="headerlink" title="19. async await"></a>19. async await</h2><p>(1) async&#x2F;await 概述</p>
<p>async&#x2F;await 是 ECMAScript 2017 中引入的新的异步编程特性。它是建立在 Promise 基础之上的，主要的不同是它提供了更为简单直接的语法机制来处理异步操作，并且可以让异步代码看起来像同步代码，这样可以提高代码的可读性和可维护性。</p>
<p>对于一个函数，只要在它的声明前面使用 async 关键字来修饰，那么它就可以使用 await 来等待异步操作的结果。以下是一个简单的例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchRemoteData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;https://api.example.com/data&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述代码中，fetchRemoteData 函数声明了 async，这意味着它可以通过 await 等待异步函数 fetch 的返回值。fetchRemoteData 函数等待 fetch 函数的响应，然后再等待它的 JSON 内容，最后返回包含 JSON 消息的数据对象。</p>
<p>(2) async&#x2F;await 原理</p>
<p>async 函数是 Promise 对象的语法糖，async 函数本身返回的是一个 Promise 对象，因此可以与其他 Promise 对象进行链式调用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">asyncFunc1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">asyncFunc2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">asyncFunc1</span>();</span><br><span class="line">  <span class="keyword">return</span> result.<span class="title function_">toUpperCase</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">asyncFunc2</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res); <span class="comment">// -&gt; &#x27;HELLO WORLD&#x27;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>在 async 函数中使用 await 表达式时，它的作用就是将异步调用的结果分割开来，使得后面的代码可以在异步调用返回结果之后继续执行。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">demo</span> () &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;step 1&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://api.example.com/data&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;step 2&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">demo</span>().<span class="title function_">then</span>(...)</span><br></pre></td></tr></table></figure>

<p>在以上例子中，当我们调用 demo() 函数时，第一行代码会打印一个“step 1”的消息，但注意此时代码并不会阻塞。随后，代码中的 await 表达式会发起一个异步调用，该调用需要一些时间来完成，我们称为“await point”。</p>
<p>(3) 异常处理</p>
<p>await 操作符也可以捕获异步操作产生的异常，就像 Promise.catch() 方法一样。因此，建议在 async 函数中使用 try-catch 块来处理可能出现的异常。以下是一个例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">divide</span> (x, y) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(x / y)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error:&#x27;</span>, err)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">divide</span>(<span class="number">10</span>, <span class="number">0</span>).<span class="title function_">then</span>(...)</span><br></pre></td></tr></table></figure>

<p>(4) 异步函数代码执行顺序说明</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;async1 start&quot;</span>);</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">async2</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;async1 end&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;async2&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">async1</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;start&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">double</span>(<span class="params">m</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(m * <span class="number">2</span>);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> r = <span class="keyword">await</span> <span class="title function_">double</span>(arr[i]);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;start&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="20-优化-DOM-操作性能"><a href="#20-优化-DOM-操作性能" class="headerlink" title="20. 优化 DOM 操作性能"></a>20. 优化 DOM 操作性能</h2><p>(1) 优化操作 DOM 的频率</p>
<p>操作 DOM 的次数越少，页面反应就越快。</p>
<p>比如，我们使用一个 for 循环向一个 ul 列表里添加 1000 个 li 元素，这会导致 1000 次 DOM 操作，对页面性能的影响很大。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> list = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;ul&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> li = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;li&quot;</span>);</span><br><span class="line">  li.<span class="property">textContent</span> = <span class="string">`Item <span class="subst">$&#123;i&#125;</span>`</span>;</span><br><span class="line">  list.<span class="title function_">appendChild</span>(li);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以使用 DocumentFragment 来高效地添加大量的 DOM 元素。</p>
<p>DocumentFragment 是一个虚拟的节点，可以将多个节点添加到 DocumentFragment 中，再将它一次性添加到 DOM 中，减少 DOM 操作的次数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> list = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;ul&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fragment = <span class="variable language_">document</span>.<span class="title function_">createDocumentFragment</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> li = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;li&quot;</span>);</span><br><span class="line">  li.<span class="property">textContent</span> = <span class="string">`Item <span class="subst">$&#123;i&#125;</span>`</span>;</span><br><span class="line">  fragment.<span class="title function_">appendChild</span>(li);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">list.<span class="title function_">appendChild</span>(fragment);</span><br></pre></td></tr></table></figure>

<p>(2) 缓存 DOM 元素的引用</p>
<p>每次获取 DOM 对象都会造成一定的性能浪费，所以我们可以使用变量来缓存 DOM 对象的引用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 未优化</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#myButton&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#myDiv&quot;</span>).<span class="property">innerHTML</span> = <span class="string">&quot;Button clicked&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 优化后</span></span><br><span class="line"><span class="keyword">const</span> myButton = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#myButton&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> myDiv = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#myDiv&quot;</span>);</span><br><span class="line"></span><br><span class="line">myButton.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  myDiv.<span class="property">innerHTML</span> = <span class="string">&quot;Button clicked&quot;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>(3) 使用事件委托</p>
<p>添加事件监听器也会影响性能，我们可以使用事件委托的方式来减少事件监听器的数量。</p>
<p>事件委托就是利用事件冒泡，将事件监听器添加到父元素上，然后根据事件冒泡的原理，在父元素上捕获事件，从而减少事件监听器的数量。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 未优化</span></span><br><span class="line"><span class="keyword">const</span> listItems = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;li&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; listItems.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  listItems[i].<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Item <span class="subst">$&#123;i&#125;</span> clicked`</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 优化后</span></span><br><span class="line"><span class="keyword">const</span> list = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;ul&quot;</span>);</span><br><span class="line"></span><br><span class="line">list.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (e.<span class="property">target</span>.<span class="property">tagName</span> === <span class="string">&quot;LI&quot;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Item <span class="subst">$&#123;e.target.textContent&#125;</span> clicked`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>(4) 使用 classList 代替 className</p>
<p>className 常用于添加、删除、替换元素的 CSS 类，但是每次操作都会重新渲染元素，影响性能。</p>
<p>所以我们可以使用 classList 来代替 className 属性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 未优化</span></span><br><span class="line"><span class="keyword">const</span> myDiv = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#myDiv&quot;</span>);</span><br><span class="line">myDiv.<span class="property">className</span> = <span class="string">&quot;foo&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 优化后</span></span><br><span class="line"><span class="keyword">const</span> myDiv = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#myDiv&quot;</span>);</span><br><span class="line">myDiv.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;foo&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>(5) 避免多次修改样式</p>
<p>在 JavaScript 代码中频繁修改样式也会影响性能，我们可以将多个样式合并成一个字符串，然后一次性修改。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 未优化</span></span><br><span class="line"><span class="keyword">const</span> myDiv = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#myDiv&quot;</span>);</span><br><span class="line"></span><br><span class="line">myDiv.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">myDiv.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&quot;white&quot;</span>;</span><br><span class="line">myDiv.<span class="property">style</span>.<span class="property">fontSize</span> = <span class="string">&quot;20px&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 优化后</span></span><br><span class="line"><span class="keyword">const</span> myDiv = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#myDiv&quot;</span>);</span><br><span class="line">myDiv.<span class="property">style</span>.<span class="property">cssText</span> = <span class="string">&quot;background-color: red; color: white; font-size: 20px;&quot;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="21-property-与-attribute"><a href="#21-property-与-attribute" class="headerlink" title="21. property 与 attribute"></a>21. property 与 attribute</h2><p>在 HTML 中，attribute 是指在 HTML 标签属性，property 是指 DOM 对象属性。</p>
<p>HTML 中的 attribute：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myDiv&quot;</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span> <span class="attr">data-value</span>=<span class="string">&quot;123&quot;</span>&gt;</span>This is a box<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以使用 JavaScript 获取 attribute 的值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myDiv = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;myDiv&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myDiv.<span class="title function_">getAttribute</span>(<span class="string">&quot;data-value&quot;</span>)); <span class="comment">// &quot;123&quot;</span></span><br></pre></td></tr></table></figure>

<p>也可以使用 JavaScript 动态设置 attribute 的值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myDiv.<span class="title function_">setAttribute</span>(<span class="string">&quot;data-value&quot;</span>, <span class="string">&quot;456&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>DOM 对象属性通过 DOM 对象点上属性的方式进行访问：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myDiv = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;myDiv&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myDiv.<span class="property">id</span>); <span class="comment">// &quot;myDiv&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myDiv.<span class="property">className</span>); <span class="comment">// &quot;box&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myDiv.<span class="property">innerHTML</span>); <span class="comment">// &quot;This is a box&quot;</span></span><br></pre></td></tr></table></figure>

<p>也可以通过赋值语句来修改它们的值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myDiv.<span class="property">className</span> = <span class="string">&quot;new-box&quot;</span>;</span><br><span class="line">myDiv.<span class="property">innerHTML</span> = <span class="string">&quot;This is a new box&quot;</span>;</span><br></pre></td></tr></table></figure>

<hr>
<p>HTML 标签属性和 DOM 对象属性都是为 HTML 元素提供附加信息的方式。它们之间有一定的联系，但在使用和目的方面有所不同。</p>
<ol>
<li>HTML 标签属性：</li>
</ol>
<p>HTML 标签属性主要用于在 HTML 文档中为元素提附加信息。</p>
<p>例如，<code>id</code> 属性用于为一个 HTML 元素分配唯一的标识符，<code>class</code> 属性可以分配一个或多个类名，以便使用 CSS 进行样式设置。例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">  <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">id</span>=<span class="string">&quot;username&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">placeholder</span>=<span class="string">&quot;请输入用户名&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>DOM 对象属性：</li>
</ol>
<p>DOM 即文档对象模型（Document Object Model），是一个编程接口，允许我们使用 JavaScript 操作 HTML 文档的结构、样式和内容。</p>
<p>浏览器在读取 HTML 标签时，会生成标签对应的 DOM 对象，标准的 HTML 标签属性会成为 DOM 对象属性。</p>
<p>DOM 对象属性是我们在 JavaScript 中与 HTML 元素互动时所使用的属性，它不仅包括 HTML 属性，还包括其他与元素相关的属性。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> element = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;username&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(element.<span class="property">tagName</span>); <span class="comment">// 输出元素的标签名称</span></span><br><span class="line">element.<span class="property">disabled</span> = <span class="literal">true</span>; <span class="comment">// 将输入框设置为禁用状态</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>不同点：</li>
</ol>
<ul>
<li><p>HTML 标签属性仅仅存在于 HTML 文档中，而 DOM 对象属性是我们 在 JavaScript 中使用的属性。</p>
</li>
<li><p>DOM 对象属性包含更多信息，除了标准的 HTML 标签属性以外还包括元素事件处理、元素宽高等。</p>
</li>
<li><p>有时，DOM 对象属性和 HTML 标签属性可能有区别。</p>
<ul>
<li><code>checked</code> 和 <code>selected</code> 在 HTML 中是布尔属性，但在 DOM 中是布尔值。</li>
<li><code>value</code> 属性，HTML 标签的 value 属性始终存储的是设置属性时赋的默认值，而 DOM 对象中的 value 属性保存的是用户输入的内容。</li>
<li><code>class</code> 属性用于在 HTML 标签中为元素设置类名，<code>className</code> 属性用于在 DOM 对象中设置元素类名。</li>
<li></li>
</ul>
</li>
<li><p>一些 HTML 标签属性没有对应的 DOM 对象属性, 比如 aria-*, colspan 等</p>
</li>
<li><p>一些 DOM 对象属性没有对应的 HTML 标签属性, 比如 textContent 等</p>
</li>
</ul>
<p>在实际项目中，你应该根据需要进行选择：</p>
<ul>
<li>在 HTML 标签中，使用 HTML 属性定义元素的特征和基础数据。</li>
<li>在 JavaScript 代码中，通过操作 DOM 对象属性实现动态交互和修改元素状态。</li>
</ul>
<p>代码示例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 设置HTML标签属性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;toggleBtn&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>切换禁用状态<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">  <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">id</span>=<span class="string">&quot;username&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">placeholder</span>=<span class="string">&quot;请输入用户名&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// JavaScript访问和操作DOM对象属性</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> toggleBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;toggleBtn&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> inputElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;username&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  toggleBtn.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    inputElement.<span class="property">disabled</span> = !inputElement.<span class="property">disabled</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面的代码中，我们在 HTML 中设置了基本的属性，然后在 JavaScript 中操作 DOM 对象属性实现点击按钮时切换输入框的禁用状态。</p>
<h2 id="22-通用的绑定事件的方法"><a href="#22-通用的绑定事件的方法" class="headerlink" title="22. 通用的绑定事件的方法"></a>22. 通用的绑定事件的方法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addEvent</span>(<span class="params">el, eventType, callback</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (el.<span class="property">addEventListener</span>) &#123;</span><br><span class="line">    el.<span class="title function_">addEventListener</span>(eventType, callback, <span class="literal">false</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (el.<span class="property">attachEvent</span>) &#123;</span><br><span class="line">    el.<span class="title function_">attachEvent</span>(<span class="string">&quot;on&quot;</span> + eventType, callback);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    el[<span class="string">&quot;on&quot;</span> + eventType] = callback;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>el 是要绑定事件的元素，eventType 是要绑定的事件类型，callback 是事件处理程序。</p>
<p>这个方法支持现代浏览器、IE8+及更低版本的 IE 浏览器，以及不支持 addEventListener 的其他浏览器。</p>
<p>说出 onLoad (window) 事件与 DOMContentLoaded (document) 事件的区别？</p>
<h2 id="23-事件冒泡"><a href="#23-事件冒泡" class="headerlink" title="23. 事件冒泡"></a>23. 事件冒泡</h2><p>事件冒泡是指当一个元素上的事件被触发时，该事件会向父元素传递，如果父元素也绑定了该事件，则会接着触发父元素上的事件，以此类推直至到达最外层的祖先元素为止。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;outer&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;middle&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;inner&quot;</span>&gt;</span>Click me!<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> outer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;outer&quot;</span>);</span><br><span class="line">outer.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Outer div clicked!&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> middle = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;middle&quot;</span>);</span><br><span class="line">middle.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Middle div clicked!&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> inner = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;inner&quot;</span>);</span><br><span class="line">inner.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Button clicked!&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>当点击按钮时，控制台会打印以下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Button clicked!</span><br><span class="line">Middle div clicked!</span><br><span class="line">Outer div clicked!</span><br></pre></td></tr></table></figure>

<h2 id="24-事件委托"><a href="#24-事件委托" class="headerlink" title="24. 事件委托"></a>24. 事件委托</h2><p>事件委托是指将事件处理程序绑定在某一元素的祖先元素上，通过祖先元素处理该事件，这能够优化性能并减少事件处理程序的数量。</p>
<p>下面是一个示例，当单击一个 ul 元素的下拉菜单项时，会执行相应的操作：</p>
<p>HTML 代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;menu&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>菜单项 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>菜单项 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>菜单项 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>JavaScript 代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> menu = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.menu&quot;</span>);</span><br><span class="line">menu.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (event.<span class="property">target</span>.<span class="property">tagName</span> === <span class="string">&quot;LI&quot;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;你点击了菜单项：&quot;</span>, event.<span class="property">target</span>.<span class="property">textContent</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="25-Ajax"><a href="#25-Ajax" class="headerlink" title="25. Ajax"></a>25. Ajax</h2><p>在原生 JavaScript 中，我们可以使用 XMLHttpRequest 对象发送 Ajax 请求。</p>
<p>一、概述</p>
<p>Ajax 是 Asynchronous JavaScript and XML 的缩写，它是一种使用 JavaScript 在不刷新页面的情况下与服务器交换数据的技术。</p>
<p>二、创建 XMLHttpRequest 对象</p>
<p>要使用 XMLHttpRequest，首先需要创建一个 XMLHttpRequest 对象的实例。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br></pre></td></tr></table></figure>

<p>三、设置请求</p>
<p>当实例创建完毕后，可以使用 XMLHttpRequest 对象的 open() 方法来设置请求，open() 方法接受三个参数：</p>
<ul>
<li>请求的类型（GET 或 POST）</li>
<li>请求的 URL</li>
<li>请求是否异步（true 表示异步，false 表示同步）</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;https://api.example.com/data&quot;</span>, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure>

<p>四、发送请求</p>
<p>设置好请求之后，可以使用 XMLHttpRequest 对象的 send() 方法来发送请求。</p>
<p>如果是 GET 请求，send() 方法不需要参数；</p>
<p>如果是 POST 请求，send() 方法需要传递一个字符串或 FormData 对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="title function_">send</span>();</span><br></pre></td></tr></table></figure>

<p>五、处理响应</p>
<p>要处理服务器返回的响应，可以使用 XMLHttpRequest 对象的 onreadystatechange 事件处理程序。</p>
<p>当请求的状态（readyState）发生变化时，onreadystatechange 事件处理程序将被触发。</p>
<p>readyState 的可能值包括：</p>
<ul>
<li>0：请求未初始化（已创建 XMLHttpRequest 实例，但尚未调用 open() 方法）</li>
<li>1：请求已经设置（已调用 open() 方法，但尚未调用 send() 方法）</li>
<li>2：请求已发送（已调用 send() 方法，但尚未收到响应）</li>
<li>3：请求处理中（已收到部分响应数据）</li>
<li>4：请求已完成（已收到所有的响应数据）</li>
</ul>
<p>当 readyState 等于 4 且 HTTP 状态码为 200 时，表示请求成功，此时可以获取并处理服务器返回的数据。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line"></span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;https://api.example.com/data&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.<span class="title function_">send</span>();</span><br></pre></td></tr></table></figure>

<p>实际项目中的代码示例：</p>
<ol>
<li>获取 GitHub 用户信息：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line"></span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> user = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;GitHub 用户名：&quot;</span> + user.<span class="property">login</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;https://api.github.com/users/octocat&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.<span class="title function_">send</span>();</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>从 API 中获取一条随机笑话：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line"></span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> joke = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;随机笑话：&quot;</span> + joke.<span class="property">value</span>.<span class="property">joke</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;https://api.icndb.com/jokes/random&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.<span class="title function_">send</span>();</span><br></pre></td></tr></table></figure>

<h2 id="26-跨域"><a href="#26-跨域" class="headerlink" title="26. 跨域"></a>26. 跨域</h2><p>(1) 跨域概述</p>
<p>跨域是指跨越原始访问控制(domains)的访问。</p>
<p>在 Web 应用中，浏览器出于安全考虑一般情况下是只允许同源请求。</p>
<p>所谓同源就是协议、域名以及端口号相同，如果请求的资源来自于不同的源（域名、端口、协议），则会出现跨域。</p>
<p>这种安全策略被称为 “同源策略”，同源策略的主要目的是为了保证用户信息的安全，阻止恶意攻击。</p>
<p>如果没有同源策略，攻击者可以通过编写脚本，从一个网站发送请求绕过用户认证，获取用户的隐私数据。</p>
<p>(2) 如何解决跨域问题</p>
<p>① JSONP</p>
<p>JSONP (JSON with Padding) 是一种通过 script 标签跨域访问数据的方式，因为 script 标签本身就允许跨域。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 客户端</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">jsonp</span>(<span class="params">url, callbackName</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;script&quot;</span>);</span><br><span class="line">  script.<span class="property">src</span> = <span class="string">`<span class="subst">$&#123;url&#125;</span>?callback=<span class="subst">$&#123;callbackName&#125;</span>`</span>;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleData</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">jsonp</span>(<span class="string">&quot;https://example.com/jsonp&quot;</span>, <span class="string">&quot;handleData&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 服务端</span></span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&quot;url&quot;</span>);</span><br><span class="line"></span><br><span class="line">http</span><br><span class="line">  .<span class="title function_">createServer</span>(<span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> query = url.<span class="title function_">parse</span>(req.<span class="property">url</span>, <span class="literal">true</span>).<span class="property">query</span>;</span><br><span class="line">    <span class="keyword">const</span> callback = query.<span class="property">callback</span>;</span><br><span class="line">    <span class="keyword">const</span> data = &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;Jack&quot;</span>,</span><br><span class="line">      <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123; <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/javascript&quot;</span> &#125;);</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">`<span class="subst">$&#123;callback&#125;</span>(<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(data)&#125;</span>)`</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">listen</span>(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>

<p>需要注意的是，JSONP 总是发起一个 GET 请求，所以仅仅适用于请求数据，而不能发送数据。</p>
<p>② CORS (跨域资源共享)</p>
<p>CORS 是一种更为现代化的跨域方案，它允许浏览器与服务器之间进行跨域通信。</p>
<p>服务端需要在响应头中添加 CORS 相关配置，例如 Access-Control-Allow-Origin，这样客户端就可以跨域访问该资源。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 客户端</span></span><br><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;https://example.com/api/data&quot;</span>);</span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">xhr.<span class="title function_">send</span>();</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 服务端</span></span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"></span><br><span class="line">http</span><br><span class="line">  .<span class="title function_">createServer</span>(<span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    res.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;</span><br><span class="line">      <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">      <span class="string">&quot;Access-Control-Allow-Origin&quot;</span>: <span class="string">&quot;*&quot;</span>, <span class="comment">// &quot;*&quot; 表示允许任何域名跨域访问，也可以设置指定域名</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> data = &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;Lily&quot;</span>,</span><br><span class="line">      <span class="attr">age</span>: <span class="number">22</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">end</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data));</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">listen</span>(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>

<p>除了以上两种方法，还有其他一些常用的跨域解决方案，如使用代理服务器、postMessage 通信等。</p>
<h2 id="27-本地存储"><a href="#27-本地存储" class="headerlink" title="27. 本地存储"></a>27. 本地存储</h2><p>cookie 是浏览器保存用户数据的一种方式。</p>
<p>localStorage 和 sessionStorage 是 HTML5 引入的 Web Storage，同样是用于在浏览器中保存数据。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置cookie</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> =</span><br><span class="line">  <span class="string">&quot;name=John Doe; expires=Thu, 18 Dec 2022 12:00:00 UTC; path=/&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取cookie</span></span><br><span class="line"><span class="keyword">let</span> name = <span class="variable language_">document</span>.<span class="property">cookie</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 存储数据</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;John Doe&quot;</span>);</span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;30&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取数据</span></span><br><span class="line"><span class="keyword">let</span> name = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;name&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> age = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;age&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name, age);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 存储数据</span></span><br><span class="line">sessionStorage.<span class="title function_">setItem</span>(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;John Doe&quot;</span>);</span><br><span class="line">sessionStorage.<span class="title function_">setItem</span>(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;30&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取数据</span></span><br><span class="line"><span class="keyword">let</span> name = sessionStorage.<span class="title function_">getItem</span>(<span class="string">&quot;name&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> age = sessionStorage.<span class="title function_">getItem</span>(<span class="string">&quot;age&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name, age);</span><br></pre></td></tr></table></figure>

<p>cookie 保存数据的容量较小，只有 4KB 左右，而 localStorage 和 sessionStorage 可以存储更多数据。</p>
<p>cookie 可以设置过期时间，不过需要手动管理，而 localStorage 和 sessionStorage 可以无限期保存数据。</p>
<p>cookie 可以跨域传递数据，而 localStorage 和 sessionStorage 只能在同源页面之间共享数据。</p>
<p>cookie 保存在浏览器的 cookie 文件夹中，localStorage 和 sessionStorage 保存在浏览器中的特定位置，更安全。</p>
<p>如果需要跨页面或跨域传递数据，或者需要在用户不主动清除浏览器缓存的情况下保存数据，建议使用 cookie。</p>
<p>如果需要在同源页面中保存少量数据，建议使用 localStorage。</p>
<p>如果需要在同源页面中保存临时数据，建议使用 sessionStorage。</p>
<h2 id="28-HTTP-协议"><a href="#28-HTTP-协议" class="headerlink" title="28. HTTP 协议"></a>28. HTTP 协议</h2><p>(1) HTTP 协议概述</p>
<p>HTTP (Hypertext Transfer Protocol) 是一种在 Web 应用中进行数据通信的协议。</p>
<p>在客户端和服务器之间交换的所有数据（例如 HTML 文件、图像文件、查询结果等）都必须遵循 HTTP 协议中规定的格式。</p>
<p>HTTP 协议基于客户端服务器模型，客户端发送请求，服务器发送响应。</p>
<p>通常，Web 浏览器是作为客户端出现的。当您在浏览器中输入一个 URL 时，这实际上向服务器发出了一个请求，以获取网页。</p>
<p>服务器将响应包含在一个 HTTP 格式的消息中，并将其发送回给浏览器。浏览器将消息解析并显示响应的文本、图像等内容。</p>
<p>HTTP 格式的消息分为两类：请求和响应。</p>
<p>(2) HTTP 请求</p>
<p>HTTP 请求由三个部分组成：</p>
<ol>
<li>请求方法：指定对服务器执行的操作类型。常用方法包括 GET、POST、PUT、DELETE 等。</li>
<li>请求 URI：指定要操作的资源的 URI。</li>
<li>HTTP 版本：该消息所使用的 HTTP 版本。</li>
</ol>
<p>例如，以下是一个 HTTP GET 请求的示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /index.html HTTP/1.1</span><br><span class="line">Host: www.example.com</span><br></pre></td></tr></table></figure>

<p>这个请求由 GET 方法（请求获取资源）组成，请求的 URI 是 <code>/index.html</code>，HTTP 版本是 1.1。</p>
<p>请求消息可以包含其他信息，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET /search?q=example HTTP/1.1</span><br><span class="line">Host: www.google.com</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3</span><br></pre></td></tr></table></figure>

<p>其中，Accept-Encoding 和 User-Agent 是请求首部。</p>
<p>(3) HTTP 响应</p>
<p>HTTP 响应也由三个部分组成：</p>
<ol>
<li>状态码：指定执行该请求后服务器的状态。常见的状态码包括 200 OK（请求成功）、404 Not Found（未找到请求的资源）等。</li>
<li>响应首部：包含与响应相关的元数据，如服务器类型、响应时间等。</li>
<li>实体：包含响应的实际内容，例如网页、图像等。</li>
</ol>
<p>以下是一个 HTTP 响应的示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line">Content-Length: 138</span><br><span class="line">Date: Tue, 06 Jun 2017 09:45:32 GMT</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Welcome to Example.com&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Hello World!&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>状态码为 200（请求成功），并且响应实体中包含一个 HTML 页面。</p>
<p>(4) HTTP 方法</p>
<p>HTTP 协议支持多种请求方法。以下是一些常见的方法：</p>
<ol>
<li>GET：请求获取资源。应该只用于获取数据，不应更改数据。</li>
<li>POST：请求向服务器提交数据。该请求可能导致服务器更改状态或执行其他操作。</li>
<li>PUT：请求更新服务器上的资源。</li>
<li>DELETE：请求删除服务器上的资源。</li>
</ol>
<p>(5) HTTP 状态码</p>
<p>HTTP 响应状态码指示 HTTP 请求是否已成功完成。以下是一些常见的状态码及其含义：</p>
<ol>
<li>200 OK：请求已成功完成。</li>
<li>201 Created：服务器已成功创建新资源。</li>
<li>400 Bad Request：请求无效，例如缺少一些必需的参数。</li>
<li>401 Unauthorized：未授权，需要身份验证。</li>
<li>404 Not Found：请求的资源不存在。</li>
<li>500 Internal Server Error：服务器遇到了错误，无法完成请求。</li>
</ol>
<h2 id="29-restful-API"><a href="#29-restful-API" class="headerlink" title="29. restful API"></a>29. restful API</h2><p>RESTful（Representational State Transfer）是一种软件架构风格，主要用于网络上的 web 服务。</p>
<p>RESTful API 按照资源进行设计，使用标准的 HTTP 方法，如 GET、POST、PUT 和 DELETE，实现资源的创建、读取、更新和删除操作（CRUD 操作）。</p>
<p>资源：RESTful API 中的资源可以是一篇文章、用户信息或者商品等，这些资源可以通过 URI（统一资源标识符）进行标识，例如：&#x2F;users、&#x2F;articles 等。</p>
<p>方法：RESTful API 中的方法是 HTTP 请求动词，例如：GET、POST、PUT、DELETE 等。不同的动词表示对资源的不同操作。</p>
<p>状态：资源的状态表示请求操作的结果，使用 HTTP 状态码来传达，如 200 表示操作成功，404 表示资源未找到，500 表示服务器内部错误等。</p>
<hr>
<p>以下是一个使用 Node.js 的 Express 框架创建的简单 RESTful 风格的 API 的代码示例。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入模块</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 资源：用户</span></span><br><span class="line"><span class="keyword">const</span> users = [];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法：</span></span><br><span class="line"><span class="comment">// 1. 获取所有用户：GET /users</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/users&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(users);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 创建用户：POST /users</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/users&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> newUser = &#123;</span><br><span class="line">    <span class="attr">id</span>: users.<span class="property">length</span> + <span class="number">1</span>,</span><br><span class="line">    <span class="attr">name</span>: req.<span class="property">body</span>.<span class="property">name</span>,</span><br><span class="line">    <span class="attr">age</span>: req.<span class="property">body</span>.<span class="property">age</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  users.<span class="title function_">push</span>(newUser);</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">json</span>(newUser);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 获取单个用户：GET /users/:id</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/users/:id&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> user = users.<span class="title function_">find</span>(<span class="function">(<span class="params">u</span>) =&gt;</span> u.<span class="property">id</span> === <span class="built_in">parseInt</span>(req.<span class="property">params</span>.<span class="property">id</span>));</span><br><span class="line">  <span class="keyword">if</span> (!user) res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">send</span>(<span class="string">&quot;用户未找到。&quot;</span>);</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(user);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 修改用户信息：PUT /users/:id</span></span><br><span class="line">app.<span class="title function_">put</span>(<span class="string">&quot;/users/:id&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> user = users.<span class="title function_">find</span>(<span class="function">(<span class="params">u</span>) =&gt;</span> u.<span class="property">id</span> === <span class="built_in">parseInt</span>(req.<span class="property">params</span>.<span class="property">id</span>));</span><br><span class="line">  <span class="keyword">if</span> (!user) res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">send</span>(<span class="string">&quot;用户未找到。&quot;</span>);</span><br><span class="line"></span><br><span class="line">  user.<span class="property">name</span> = req.<span class="property">body</span>.<span class="property">name</span>;</span><br><span class="line">  user.<span class="property">age</span> = req.<span class="property">body</span>.<span class="property">age</span>;</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(user);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. 删除用户：DELETE /users/:id</span></span><br><span class="line">app.<span class="title function_">delete</span>(<span class="string">&quot;/users/:id&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> user = users.<span class="title function_">find</span>(<span class="function">(<span class="params">u</span>) =&gt;</span> u.<span class="property">id</span> === <span class="built_in">parseInt</span>(req.<span class="property">params</span>.<span class="property">id</span>));</span><br><span class="line">  <span class="keyword">if</span> (!user) res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">send</span>(<span class="string">&quot;用户未找到。&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> index = users.<span class="title function_">indexOf</span>(user);</span><br><span class="line">  users.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">204</span>).<span class="title function_">send</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = process.<span class="property">env</span>.<span class="property">PORT</span> || <span class="number">3000</span>;</span><br><span class="line">app.<span class="title function_">listen</span>(port, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Listening on port <span class="subst">$&#123;port&#125;</span>...`</span>));</span><br></pre></td></tr></table></figure>

<h2 id="30-数组-splice、slice"><a href="#30-数组-splice、slice" class="headerlink" title="30. 数组 splice、slice"></a>30. 数组 splice、slice</h2><p>在 JavaScript 中，数组的 splice 和 slice 是两个用于操作数组的方法，它们的用法和区别如下：</p>
<p>splice 方法用于在数组内插入、删除或替换元素。语法如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array.<span class="title function_">splice</span>(startIndex, deleteCount, item1, ..., itemN)</span><br></pre></td></tr></table></figure>

<p>startIndex：开始变更的索引（包括该位置的元素）</p>
<p>deleteCount：要删除的元素个数，可选。如果省略该参数，那么 startIndex 之后的所有元素都会被删除。</p>
<p>item1, …, itemN：要插入到数组中的元素，可选。</p>
<p>splice 方法的返回值是一个包含被删除元素的数组。如果没有元素被删除，则返回一个空数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">const</span> removed = arr.<span class="title function_">splice</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">8</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">// [1, 7, 8, 4, 5]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(removed); <span class="comment">// [2, 3]</span></span><br></pre></td></tr></table></figure>

<p>slice 方法用于截取数组的子数组。它不会修改原数组，而是返回一个新的数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array.<span class="title function_">slice</span>(startIndex, endIndex);</span><br></pre></td></tr></table></figure>

<p>startIndex：起始索引（包含），可选。默认值为 0。</p>
<p>endIndex：结束索引（不包含），可选。默认值为数组的长度。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">const</span> newArr = arr.<span class="title function_">slice</span>(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">// [1, 2, 3, 4, 5] （原数组不变）</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newArr); <span class="comment">// [2, 3, 4]</span></span><br></pre></td></tr></table></figure>

<p>splice 和 slice 区别：</p>
<ol>
<li>splice 方法会修改原数组，而 slice 方法不会修改原数组，而是返回一个新数组。</li>
<li>splice 方法可以插入、删除、替换元素，而 slice 方法用于截取子数组。</li>
<li>endIndex 参数在 slice 中是不包含在返回数组中的，而 splice 的 deleteCount 则是包含在被删除的元素个数中。</li>
</ol>
<h2 id="31-map-与-parseInt"><a href="#31-map-与-parseInt" class="headerlink" title="31. map 与 parseInt"></a>31. map 与 parseInt</h2><p>请说出下列代码的返回值是什么</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>].<span class="title function_">map</span>(<span class="built_in">parseInt</span>);</span><br></pre></td></tr></table></figure>

<p>以上代码是想将数组 [10, 20, 30] 中的每个元素用 parseInt 函数解析成整数，然而实际执行结果却与预期不符：执行后的结果是 [10, NaN, NaN]。</p>
<p>为了理解这个现象，我们需要深入了解 map 和 parseInt 函数的工作原理。</p>
<p>map 是数组的一个方法，它接收一个函数作为参数。map 会遍历数组的每一个元素，并对每个元素执行传入的函数。</p>
<p>传入的函数有三个参数：当前元素、当前元素的索引和整个数组。</p>
<p>map 函数返回一个新的数组，这个新数组中的元素是原数组每个元素经过传入函数处理后的结果。</p>
<p>parseInt 是一个全局函数，用于将字符串转换为整数。</p>
<p>它接受两个参数：要解析的字符串和一个可选的基数（例如 2 表示二进制，10 表示十进制等）。</p>
<p>当提供基数时，parseInt 会按照给定的进制把字符串转换为对应的整数。</p>
<p>当我们将 parseInt 传入 map 函数时，map 函数会依次为数组中每个元素调用 parseInt 函数，并把当前元素值、索引和整个数组分别传给 parseInt 的第一个、第二个和第三个参数。然而此时 parseInt 函数的第二个参数并非作为解析的基数，而是把数组索引作为基数了。这就导致了实际执行结果与预期不符。</p>
<p>当处理第一个元素（10）时，<code>parseInt</code> 接收到的参数是 <code>parseInt(10, 0)</code>（0 是数组索引）。基数为 0 时，<code>parseInt</code> 会默认按照十进制进行解析，因此结果是 10。</p>
<p>当处理第二个元素（20）时，<code>parseInt</code> 接收到的参数是 <code>parseInt(20, 1)</code>（1 是数组索引）。此时基数为 1，但 1 是一个无效的基数，因此 <code>parseInt</code> 函数会返回 <code>NaN</code>。</p>
<p>当处理第三个元素（30）时，<code>parseInt</code> 接收到的参数是 <code>parseInt(30, 2)</code>（2 是数组索引）。此时基数为 2，即二进制，而 30 并不符合二进制表示，所以 <code>parseInt</code> 返回 <code>NaN</code>。</p>
<p>因此，<code>[10, 20, 30].map(parseInt)</code> 的执行结果是 <code>[10, NaN, NaN]</code>。</p>
<p>如果你想用 map 函数将 [10, 20, 30] 中的每个元素转换为整数，可以这样做：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>].<span class="title function_">map</span>(<span class="function">(<span class="params">num</span>) =&gt;</span> <span class="built_in">parseInt</span>(num));</span><br></pre></td></tr></table></figure>

<p>这样就可以得到预期的结果 <code>[10, 20, 30]</code>。</p>
<h2 id="32-函数声明与函数表达式"><a href="#32-函数声明与函数表达式" class="headerlink" title="32. 函数声明与函数表达式"></a>32. 函数声明与函数表达式</h2><p>函数声明（Function Declaration）和函数表达式（Function Expression）都是在 JavaScript 中定义和创建函数的两种方法。</p>
<p><strong>1. 函数声明（Function Declaration）</strong></p>
<p>函数声明是使用 <code>function</code> 关键字后跟函数名称和函数体来定义函数的方法。函数声明会在代码执行前被初始化，因此可以在声明之前调用。这种行为被称为函数提升（hoisting）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数声明</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">greeting</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Hello, &quot;</span> + name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用函数</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">greeting</span>(<span class="string">&quot;John&quot;</span>));</span><br></pre></td></tr></table></figure>

<p><strong>2. 函数表达式（Function Expression）</strong></p>
<p>函数表达式是将一个函数赋值给一个变量。函数表达式在执行到其所在行时，通过变量名进行调用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数表达式</span></span><br><span class="line"><span class="keyword">const</span> greeting = <span class="keyword">function</span> (<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Hello, &quot;</span> + name;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用函数</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">greeting</span>(<span class="string">&quot;John&quot;</span>));</span><br></pre></td></tr></table></figure>

<p><strong>函数声明与函数表达式的区别：</strong></p>
<ol>
<li>提升：函数声明在执行前会被提升，这意味着你可以在声明之前调用它。而函数表达式需要等到其所在行被执行后，才可被调用。</li>
<li>语法：函数声明需要提供一个函数名，而函数表达式可以是命名的也可以是匿名的。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数声明提升示例</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">square</span>(<span class="number">5</span>)); <span class="comment">// 输出：25</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">square</span>(<span class="params">num</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> num * num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数表达式提升示例</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">square</span>(<span class="number">5</span>)); <span class="comment">// 会抛出 TypeError: square is not a function</span></span><br><span class="line"><span class="keyword">const</span> square = <span class="keyword">function</span> (<span class="params">num</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> num * num;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="33-手写-trim-方法"><a href="#33-手写-trim-方法" class="headerlink" title="33. 手写 trim 方法"></a>33. 手写 trim 方法</h2><p>在 JavaScript 中，字符串对象自带了 trim() 方法，可以用来去除字符串两端的空格。</p>
<p>但是如果需要自己手动实现一个 trim() 方法，可以使用正则表达式来去除字符串两端的空格。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">String</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">trim</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">replace</span>(<span class="regexp">/^\s+|\s+$/g</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用自定义的 trim() 方法</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;   Hello, World!   &quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str.<span class="title function_">trim</span>()); <span class="comment">// 输出：&#x27;Hello, World!&#x27;</span></span><br></pre></td></tr></table></figure>

<p>我们扩展了 String.prototype 对象，添加了一个名为 trim() 的方法。该方法使用正则表达式来去除字符串两端的空格，并返回处理后的字符串。</p>
<p>正则表达式 <code>/^\s+|\s+$/g</code> 匹配字符串两端的空格。其中：</p>
<ul>
<li><code>^</code> 表示匹配字符串开头；</li>
<li><code>\s+</code> 表示匹配一个或多个空格；</li>
<li><code>|</code> 表示或者；</li>
<li><code>$</code> 表示匹配字符串结尾；</li>
<li><code>g</code> 表示全局匹配。</li>
</ul>
<p>因此，<code>/^\s+|\s+$/g</code> 可以匹配字符串开头和结尾的空格，并将其替换为空字符串。</p>
<h2 id="34-手写-max-方法"><a href="#34-手写-max-方法" class="headerlink" title="34. 手写 max 方法"></a>34. 手写 max 方法</h2><blockquote>
<p>目标：编写 myMax 方法模拟 Math.max 方法的功能</p>
</blockquote>
<p>可以使用 apply() 方法来模拟 Math.max 方法的功能。</p>
<p>apply() 方法可以接受一个数组作为参数，并将其展开为一系列参数，传递给函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myMax</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> max = <span class="variable language_">arguments</span>[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">arguments</span>[i] &gt; max) &#123;</span><br><span class="line">      max = <span class="variable language_">arguments</span>[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> max;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> nums = [<span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">let</span> maxNum = myMax.<span class="title function_">apply</span>(<span class="literal">null</span>, nums);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(maxNum); <span class="comment">// 输出：9</span></span><br></pre></td></tr></table></figure>

<h2 id="35-捕获异常"><a href="#35-捕获异常" class="headerlink" title="35. 捕获异常"></a>35. 捕获异常</h2><p>在 JavaScript 中，可以使用 try-catch 语句来捕获异常。</p>
<p>try-catch 语句包含两个关键字：try 和 catch。try 代码块中包含可能会引发异常的代码，而 catch 代码块用于处理异常情况。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// 可能会引发异常的代码</span></span><br><span class="line">  <span class="keyword">let</span> x = y + <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="comment">// 处理异常情况</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;发生了异常：&quot;</span> + e.<span class="property">message</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>onerror 事件：用于捕获全局范围内发生的异常。可以使用 window.onerror 事件来捕获全局范围内的异常。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 该事件会在发生异常时自动触发，并将异常信息作为参数传递给事件处理函数。</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onerror</span> = <span class="keyword">function</span> (<span class="params">message, url, line, column, error</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;发生了异常：&quot;</span> + message);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="36-JSON-介绍"><a href="#36-JSON-介绍" class="headerlink" title="36. JSON 介绍"></a>36. JSON 介绍</h2><p>JSON 是一种轻量级的数据交换格式，它的全称是 JavaScript Object Notation。</p>
<p>JSON 最初是由 Douglas Crockford 在 2001 年提出的，它是一种基于文本的数据格式，具有易于阅读和编写的特点。</p>
<p>JSON 格式通常用于通过网络传输数据，因为它可以被多种编程语言解析和生成。</p>
<p>JSON 与 JavaScript 密切相关，因为 JSON 的语法是 JavaScript 对象的子集。</p>
<p>这意味着在 JavaScrip t 中，我们可以轻松地将 JSON 格式的数据转换为 JavaScript 对象，反之亦然。</p>
<p>JavaScript 提供了两个内置方法来解析和生成 JSON 数据：JSON.parse() 和 JSON.stringify()。</p>
<p>序列化：将对象转换为 JSON 字符串</p>
<p>反序列化：将 JSON 字符串转换为 JSON 对象。</p>
<h2 id="37-获取查询参数"><a href="#37-获取查询参数" class="headerlink" title="37. 获取查询参数"></a>37. 获取查询参数</h2><p>编写一个方法用于获取 url 中的查询参数并返回其对象格式。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getQueryParams</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> queryParams = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> queryString = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>.<span class="title function_">substring</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">var</span> pairs = queryString.<span class="title function_">split</span>(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; pairs.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> pair = pairs[i].<span class="title function_">split</span>(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> key = <span class="built_in">decodeURIComponent</span>(pair[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">var</span> value = <span class="built_in">decodeURIComponent</span>(pair[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> queryParams[key] === <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">      queryParams[key] = value;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(queryParams[key])) &#123;</span><br><span class="line">      queryParams[key].<span class="title function_">push</span>(value);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      queryParams[key] = [queryParams[key], value];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> queryParams;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当用户需要从 URL 中获取查询参数时，可以使用以下 JavaScript 函数来实现：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getUrlParams</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> params = &#123;&#125;;</span><br><span class="line">  <span class="keyword">const</span> regex = <span class="regexp">/([^&amp;?+]+)=([^&amp;?+]+)/g</span>;</span><br><span class="line">  url.<span class="title function_">replace</span>(regex, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    params[<span class="variable language_">arguments</span>[<span class="number">1</span>]] = <span class="variable language_">arguments</span>[<span class="number">2</span>];</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> params;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个函数使用正则表达式来匹配 URL 中的查询参数，然后将它们存储在一个对象中并返回。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://example.com/search?q=javascript&amp;lang=en&amp;page=2</span><br></pre></td></tr></table></figure>

<p>我们可以调用 getUrlParams 函数来获取查询参数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> urlParams = <span class="title function_">getUrlParams</span>(</span><br><span class="line">  <span class="string">&quot;https://example.com/search?q=javascript&amp;lang=en&amp;page=2&quot;</span></span><br><span class="line">);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(urlParams);</span><br></pre></td></tr></table></figure>

<p>这将输出以下内容：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">q</span>: <span class="string">&quot;javascript&quot;</span>,</span><br><span class="line">  <span class="attr">lang</span>: <span class="string">&quot;en&quot;</span>,</span><br><span class="line">  <span class="attr">page</span>: <span class="string">&quot;2&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="38-拍平多维数组"><a href="#38-拍平多维数组" class="headerlink" title="38. 拍平多维数组"></a>38. 拍平多维数组</h2><p>例如，调用 flatten([1, [2, 3], [4, [5, 6]]]) 将返回 [1, 2, 3, 4, 5, 6]。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">flatten</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> result = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(arr[i])) &#123;</span><br><span class="line">      result = result.<span class="title function_">concat</span>(<span class="title function_">flatten</span>(arr[i]));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      result.<span class="title function_">push</span>(arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">flatten</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> arr.<span class="title function_">reduce</span>(<span class="keyword">function</span> (<span class="params">flat, toFlatten</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> flat.<span class="title function_">concat</span>(</span><br><span class="line">      <span class="title class_">Array</span>.<span class="title function_">isArray</span>(toFlatten) ? <span class="title function_">flatten</span>(toFlatten) : toFlatten</span><br><span class="line">    );</span><br><span class="line">  &#125;, []);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="39-数组去重"><a href="#39-数组去重" class="headerlink" title="39. 数组去重"></a>39. 数组去重</h2><p>以下是使用 JavaScript 编写的一个函数，可以对数组进行去重，包括三种不同的去重方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">uniqueArray</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">  <span class="comment">// 方法一：使用 Set 数据结构</span></span><br><span class="line">  <span class="keyword">const</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>(arr);</span><br><span class="line">  <span class="keyword">const</span> uniqueArr1 = [...set];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方法二：使用 indexOf() 方法</span></span><br><span class="line">  <span class="keyword">const</span> uniqueArr2 = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (uniqueArr2.<span class="title function_">indexOf</span>(arr[i]) === -<span class="number">1</span>) &#123;</span><br><span class="line">      uniqueArr2.<span class="title function_">push</span>(arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方法三：使用 filter() 方法</span></span><br><span class="line">  <span class="keyword">const</span> uniqueArr3 = arr.<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">item, index, array</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> array.<span class="title function_">indexOf</span>(item) === index;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; uniqueArr1, uniqueArr2, uniqueArr3 &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个函数接收一个数组作为参数，并返回一个包含三种不同去重方法结果的对象。其中：</p>
<ul>
<li>方法一使用了 ES6 中的 Set 数据结构，将数组转换为 Set，然后再将 Set 转换为数组。</li>
<li>方法二使用了 for 循环和 indexOf() 方法来遍历数组，如果元素在新数组中不存在，就将其添加到新数组中。</li>
<li>方法三使用了 filter() 方法来遍历数组，只保留第一次出现的元素。</li>
</ul>
<h2 id="40-vue2-声明周期函数"><a href="#40-vue2-声明周期函数" class="headerlink" title="40. vue2 声明周期函数"></a>40. vue2 声明周期函数</h2><p>在 Vue2 中，生命周期函数是 Vue 组件会经历的一系列依次触发的函数。它们在特定时候执行，并允许开发者执行响应逻辑。</p>
<p>这些生命周期函数主要包括以下几种:</p>
<ol>
<li><p>beforeCreate：在 Vue 实例初始化之后，数据观测和事件配置之前被调用。</p>
<p>表示含义：Vue 实例已经创建，但数据观测和事件还未设置。</p>
<p>执行时机：页面渲染前。</p>
<p>应用：这个阶段不能访问到 data、methods 等，通常用得较少。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="title function_">beforeCreate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;beforeCreate&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>created：在 Vue 实例创建完成后被立即调用，此时已完成数据观测，方法和计算属性的运算。</p>
<p>表示含义：Vue 实例创建完成，数据观测以及 data、methods 等已设置。</p>
<p>执行时机：页面渲染前。</p>
<p>应用：可以用于转换数据格式、初始化、扩展 methods 方法等。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&quot;Hello Vue!&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;created&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">message</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>beforeMount：在挂载开始之前被调用，相关的 render 函数首次被调用。</p>
<p>表示含义：模板编译完成，但 DOM 还没有挂载。</p>
<p>执行时机：页面渲染前。</p>
<p>应用：一般不会在这个阶段操作，因为没有渲染出 DOM。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">  <span class="title function_">beforeMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;beforeMount&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>mounted：在 Vue 实例挂载完成时调用。此时已完成模板到 DOM 的挂载。</p>
<p>表示含义：完成 DOM 挂载，可以操作 DOM。</p>
<p>执行时机：页面渲染后。</p>
<p>应用：你可以在这里操作 DOM，比如插入插件或者调用接口。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;mounted&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>beforeUpdate：数据发生变化时，且发生在虚拟 DOM 重新渲染和打补丁之前调用。</p>
<p>表示含义：数据已更新，但 DOM 还没有更新。</p>
<p>执行时机：页面更新前。</p>
<p>应用：可以在更新之前进行某些操作，比如离开当前页面前做个提示。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&quot;Hello Vue!&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">beforeUpdate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;beforeUpdate&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>updated：在虚拟 DOM 重新渲染和打补丁后调用，表示 DOM 已完成更新。</p>
<p>表示含义：DOM 更新完成。</p>
<p>执行时机：页面更新后。</p>
<p>应用：可以执行依赖于 DOM 的操作，但要注意避免无限循环更新。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&quot;Hello Vue!&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">updated</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;updated&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>beforeDestroy：在 Vue 实例销毁之前调用。此时实例仍然可以完全正常使用。</p>
<p>表示含义：实例即将销毁，但仍可正常使用。</p>
<p>执行时机：销毁前。</p>
<p>应用：可以用来解绑事件或者清除定时器等。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;beforeDestroy&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>destroyed：在 Vue 实例销毁完成后调用。此时所有的绑定、实例方法等均已解除。<br>表示含义：实例已完全销毁。<br>执行时机：销毁后。<br>应用：这个阶段实例已被销毁，很少会用到。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="title function_">destroyed</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;destroyed&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ol>
<p>以上就是 Vue2 中的生命周期函数及其作用和应用。在实际项目中，我们可以根据不同需求选择合适的生命周期函数来执行相应操作。</p>
<h2 id="41-vue2-父子组件生命周期调用顺序"><a href="#41-vue2-父子组件生命周期调用顺序" class="headerlink" title="41. vue2 父子组件生命周期调用顺序"></a>41. vue2 父子组件生命周期调用顺序</h2><p>在 Vue2 中，父子组件的生命周期调用顺序如下：</p>
<ol>
<li><p>挂载阶段（Mounting）</p>
<ul>
<li>父组件：beforeCreate</li>
<li>父组件：created</li>
<li>父组件：beforeMount</li>
<li>子组件：beforeCreate</li>
<li>子组件：created</li>
<li>子组件：beforeMount</li>
<li>子组件：mounted</li>
<li>父组件：mounted</li>
</ul>
</li>
<li><p>更新阶段（Updating）</p>
<ul>
<li>父组件：beforeUpdate</li>
<li>子组件：beforeUpdate</li>
<li>子组件：updated</li>
<li>父组件：updated</li>
</ul>
</li>
<li><p>卸载阶段（Unmounting）</p>
<ul>
<li>父组件：beforeDestroy</li>
<li>子组件：beforeDestroy</li>
<li>子组件：destroyed</li>
<li>父组件：destroyed</li>
</ul>
</li>
</ol>
<h2 id="42-vue2-keep-alive-组件"><a href="#42-vue2-keep-alive-组件" class="headerlink" title="42. vue2 keep-alive 组件"></a>42. vue2 keep-alive 组件</h2><p>在 Vue2 中，keep-alive 是一个抽象组件，它的作用是缓存非活动的组件实例，以避免反复重渲染，提高性能。</p>
<p>keep-alive 自身实际上不会渲染成一个 DOM 元素。</p>
<p>(1) 应用场景</p>
<ol>
<li>列表切换渲染时：当有多个列表页面时，用户在不同的列表页面之间切换，需要保持每个列表页面的滚动位置、数据状态等。</li>
<li>页面级别的缓存：SPA 应用中，用户在不同页面之间切换时，需要保持一些页面的缓存，以提升性能并减少页面加载时间。</li>
<li>菜单切换渲染：当有多个菜单需要切换渲染时，为了保持之前菜单的状态，可以使用 keep-alive 来缓存这些菜单组件。</li>
</ol>
<p>(2) 特有生命周期函数</p>
<p>activated：当被包裹的组件激活时，执行此钩子函数。这个钩子函数表示组件被缓存后，再次被渲染到页面时调用。</p>
<p>deactivated：当被包裹的组件被缓存时，执行此钩子函数。这个钩子函数表示组件被缓存时调用。</p>
<p>(3) 实现原理</p>
<p>keep-alive 的实现原理主要基于 Vue 的虚拟 DOM 和组件的生命周期函数。</p>
<ol>
<li><p>当一个组件被包裹在 keep-alive 中时，keep-alive 会监听它的 activated 和 deactivated 钩子函数，缓存&#x2F;激活&#x2F;子组件。</p>
</li>
<li><p>keep-alive 使用了 Vue 的虚拟 DOM 实现，通过创建一个 &lt;keep-alive&gt; 的虚拟节点将对应组件的虚拟节点放入属性对应的缓存，为被包裹的组件额外添加 activated 和 deactivated 的生命周期处理，以达到激活和停用组件的目的。</p>
</li>
<li><p>当组件被激活时，keep-alive 会使用缓存中的组件 VNode 进行渲染，而不是重新创建一个新的 VNode。</p>
<p>这样，缓存的组件实例仍然保持之前的状态，不需要进行重新渲染。</p>
</li>
<li><p>当组件被停用时，keep-alive 会将其放入缓存，组件实例并未销毁，可用来再次激活组件。</p>
</li>
<li><p>可以使用 include 和 exclude 属性来指定哪些组件需要被缓存或排除。</p>
</li>
</ol>
<p>(4) 示例代码</p>
<p>假设我们有两个组件： Home.vue 和 About.vue。当导航从 Home 组件切换到 About 组件时，我们希望保留 Home 组件的状态。</p>
<ol>
<li>首先，创建两个组件文件：<code>Home.vue</code> 和 <code>About.vue</code>。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Home.vue --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;Home Page&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;Home&quot;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- About.vue --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;About Page&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;About&quot;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>接下来，在<code>App.vue</code>文件中设置我们的路由视图以及<code>keep-alive</code>组件。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- App.vue --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;nav&gt;</span><br><span class="line">      &lt;router-link to=&quot;/&quot;&gt;Home&lt;/router-link&gt;</span><br><span class="line">      &lt;router-link to=&quot;/about&quot;&gt;About&lt;/router-link&gt;</span><br><span class="line">    &lt;/nav&gt;</span><br><span class="line">    &lt;keep-alive&gt;</span><br><span class="line">      &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">    &lt;/keep-alive&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>然后，在<code>router.js</code>文件里配置我们的路由。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Router</span> <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&quot;./components/Home.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">About</span> <span class="keyword">from</span> <span class="string">&quot;./components/About.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Router</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Router</span>(&#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;history&quot;</span>,</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;home&quot;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="title class_">Home</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&quot;/about&quot;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;about&quot;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="title class_">About</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>最后，在项目入口文件<code>main.js</code>中导入路由配置。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;./router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">productionTip</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  router,</span><br><span class="line">  <span class="attr">render</span>: <span class="function">(<span class="params">h</span>) =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>),</span><br><span class="line">&#125;).$mount(<span class="string">&quot;#app&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>现在，当你在 <code>Home</code> 和 <code>About</code> 组件之间切换时，组件的状态应该被保留在 <code>keep-alive</code> 组件中。</p>
<h2 id="43-vue2-生命周期与异步请求"><a href="#43-vue2-生命周期与异步请求" class="headerlink" title="43. vue2 生命周期与异步请求"></a>43. vue2 生命周期与异步请求</h2><p>在 Vue2 中，可以执行异步请求的生命周期函数有以下几个：</p>
<ol>
<li>created：组件实例被创建后，在渲染 DOM 之前执行。</li>
<li>mounted：组件实例被挂载到 DOM 元素上之后执行。</li>
<li>updated：组件数据更新导致的虚拟 DOM 重新渲染后执行。</li>
<li>beforeRouteEnter、beforeRouteUpdate、beforeRouteLeave：在路由导航守卫中执行。</li>
</ol>
<p>在这些生命周期里，通常推荐在 created 生命周期进行异步请求。理由如下：</p>
<ol>
<li><p>created 生命周期会在渲染 DOM 之前执行。这意味着，在数据请求返回前，可以进行其他的逻辑处理，例如展示加载状态等。</p>
</li>
<li><p>如果在 mounted 生命周期发起异步请求，可能会让用户在等待数据返回时看到一个空的页面，影响用户体验。</p>
</li>
<li><p>在 updated 生命周期发起异步请求会增加不必要的更新，因为每次数据更新都会触发这个生命周期。</p>
<p>通常情况下，我们需要根据具体需求调用和更新数据。</p>
</li>
<li><p>在路由导航守卫中进行异步请求适用于那些依赖特定路由参数的场景，如需要在页面跳转前获取数据。</p>
</li>
</ol>
<p>综上，对于普通的异步请求推荐使用 created 生命周期。当然，在特定情况下，请根据具体需求选择合适的生命周期。</p>
<h2 id="44-Vue2-v-if-vs-v-show"><a href="#44-Vue2-v-if-vs-v-show" class="headerlink" title="44. Vue2 v-if vs v-show"></a>44. Vue2 v-if vs v-show</h2><p>在 Vue2 中，v-show 和 v-if 是两个用于条件渲染的指令。</p>
<p>下面分别介绍这两个指令的相同点和不同点，以及哪个指令的性能更好。</p>
<p>相同点：</p>
<ol>
<li>都是用于条件渲染。v-show 和 v-if 这两个指令都可以根据条件去渲染或者隐藏某个 HTML 元素。</li>
</ol>
<p>不同点：</p>
<ol>
<li><p>v-if 是”真正”的条件渲染指令，它会根据表达式的值在 DOM 树中插入或者删除对应的元素。</p>
<p>v-show 只是简单地切换元素的 CSS 属性 display，控制元素的显示和隐藏。</p>
</li>
<li><p>当表达式的值为 false 时，v-if 不会渲染元素到 DOM 树中</p>
<p>v-show 无论表达式的值为何始终都会渲染元素，在元素的 display 属性中设置为 none 来控制隐藏。</p>
</li>
<li><p>v-if 由于需要插入和删除 DOM 元素，当条件切换频繁时，对性能消耗较大。</p>
<p>v-show 只是简单地修改 CSS 属性，性能消耗较小。</p>
</li>
</ol>
<p>如果需要频繁切换显示隐藏的场景，建议使用 v-show，因为它只需要修改 CSS 属性，性能开销较小。</p>
<p>如果元素不需要频繁切换，或者切换时需要重新获取数据、处理逻辑等，建议使用 v-if，因为它不会多次渲染不需要的元素，从而减少性能消耗。</p>
<h2 id="45-v-for-key"><a href="#45-v-for-key" class="headerlink" title="45. v-for key"></a>45. v-for key</h2><p>问题：v-for 为什么要配合 key 一起使用？</p>
<p>在 Vue2 中，v-for 和 key 被一起使用是出于性能优化的考虑，有助于提高列表渲染的性能。</p>
<p>v-for 指令是 Vue.js 中用于循环渲染列表元素的一个重要特性。在数据发生变化时，Vue 将更新 DOM 来匹配新的数据。</p>
<p>然而，有时候我们只是对列表进行简单的添加或删除操作，如果每次都重新计算整个列表并重新渲染，则会造成浪费，降低性能。</p>
<p>为解决此问题，Vue 实现了一种名为“就地复用”的策略。</p>
<p>当列表发生变化时，它会尽可能地减少重新创建和销毁 DOM 元素的次数。如果一个元素没有 key，Vue 将尝试使用 tag 复用现有元素。</p>
<p>然而，这种复用策略可能会导致一些问题。例如当列表元素的顺序发生变化时，它可能会导致不必要的更新，从而导致性能问题。</p>
<p>这时我们需要使用 key 属性来指定一个唯一标识符，使得 Vue 可以准确地识别每一个列表项。</p>
<p>key 属性应该为每一个列表项分配一个唯一的值，便于 Vue 知道如何对应新旧元素。</p>
<p>这样，当数据发生变化时，Vue 可以通过 key 属性来识别哪个元素被添加、修改或者删除，从而实现更有效的局部更新，提高列表渲染性能。</p>
<h2 id="46-Vue2-组件通讯"><a href="#46-Vue2-组件通讯" class="headerlink" title="46. Vue2 组件通讯"></a>46. Vue2 组件通讯</h2><p>在 Vue2 中，我们可以使用以下方式实现组件之间的通信：</p>
<p>(1) 父组件向子组件传递数据：通过 props</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">child-component</span> <span class="attr">:parent-data</span>=<span class="string">&quot;data&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">child-component</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ChildComponent</span> <span class="keyword">from</span> <span class="string">&quot;./ChildComponent.vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ChildComponent</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">data</span>: <span class="string">&quot;父组件数据&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; parentData &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">parentData</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">required</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>(2) 子组件向父组件传递数据，通过自定义事件和 $emit</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">child-component</span> @<span class="attr">child-event</span>=<span class="string">&quot;handleChildEvent&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">child-component</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ChildComponent</span> <span class="keyword">from</span> <span class="string">&quot;./ChildComponent.vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ChildComponent</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">handleChildEvent</span>(<span class="params">payload</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;子组件传递的数据：&quot;</span>, payload);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;sendDataToParent&quot;</span>&gt;</span>发送数据至父组件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">sendDataToParent</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.$emit(<span class="string">&quot;child-event&quot;</span>, <span class="string">&quot;来自子组件的数据&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>(3) 兄弟组件之间通信需要通过共同的父组件，或者使用事件总线（Event Bus）</p>
<p>首先创建一个新的事件总线实例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// event-bus.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">EventBus</span> = <span class="keyword">new</span> <span class="title class_">Vue</span>();</span><br></pre></td></tr></table></figure>

<p>组件 A 发送数据至组件 B：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;sendDataToSibling&quot;</span>&gt;</span>发送数据至兄弟组件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">EventBus</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@/event-bus.js&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">sendDataToSibling</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">EventBus</span>.$emit(<span class="string">&quot;sibling-event&quot;</span>, <span class="string">&quot;来自组件 A 的数据&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>组件 B 接收数据：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>接收到的数据：&#123;&#123; receivedData &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">EventBus</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@/event-bus.js&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">receivedData</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">EventBus</span>.$on(<span class="string">&quot;sibling-event&quot;</span>, <span class="variable language_">this</span>.<span class="property">handleSiblingData</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">EventBus</span>.$off(<span class="string">&quot;sibling-event&quot;</span>, <span class="variable language_">this</span>.<span class="property">handleSiblingData</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">handleSiblingData</span>(<span class="params">payload</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">receivedData</span> = payload;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意：使用事件总线时，不要忘记在组件销毁时移除对应的事件监听，避免内存泄漏。</p>
<h2 id="47-v-model-的实现原理"><a href="#47-v-model-的实现原理" class="headerlink" title="47. v-model 的实现原理"></a>47. v-model 的实现原理</h2><p>Vue.js 中的 v-model 是实现表单控件与数据双向绑定的指令。</p>
<p>其实现原理主要基于两个部分：数据到视图的绑定（数据驱动视图更新）和视图到数据的绑定（视图驱动数据更新）。</p>
<p>数据到视图的绑定：当数据发生变化时，通过数据劫持（Vue.js 2.x 使用 Object.defineProperty，Vue.js 3.x 使用 Proxy）触发数据变化的侦听函数，然后通过订阅者模式通知相应的指令更新，最后视图更新。</p>
<p>视图到数据的绑定：当用户与视图交互（如输入文本、选择选项等）时，通过监听视图的 input 事件，获取视图的最新值，然后将其赋值给相应的数据，实现视图到数据的绑定。</p>
<p>下面是一个 Vue.js 的代码示例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 使用 v-model 进行双向数据绑定 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;message&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">message</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在这个示例中，我们使用 v-model 指令将输入框与 data 中的 message 属性进行双向绑定。当用户输入文本时，视图到数据的绑定将用户的输入赋值给 message 属性；同时，数据到视图的绑定会自动将 message 的最新值更新到视图上，展示在 <code>&lt;p&gt;</code> 标签中。</p>
<p>在原生 JavaScript 中，你可以使用事件监听器和数据代理来实现一个简单的双向数据绑定。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;input&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;output&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 1. 获取 DOM 元素</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;input&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> output = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;output&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 2. 初始化一个数据对象</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> data = &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">value</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 3. 代理数据对象，监听数据变化</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="title class_">Proxy</span>(data, &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">set</span>(<span class="params">target, key, value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          target[key] = value;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 更新 DOM</span></span></span><br><span class="line"><span class="language-javascript">          output.<span class="property">innerText</span> = value;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 4. 监听 input 事件，并更新数据对象</span></span></span><br><span class="line"><span class="language-javascript">      input.<span class="title function_">addEventListener</span>(<span class="string">&quot;input&quot;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        proxy.<span class="property">value</span> = e.<span class="property">target</span>.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 初始更新</span></span></span><br><span class="line"><span class="language-javascript">      proxy.<span class="property">value</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个示例中，我们创建了一个简单的数据代理，使用 Proxy 对象来代理一个初始数据对象并在数据对象的值被设置时更新 DOM。然后，我们使用事件监听器监听 input 元素的输入事件，并在输入值发生变化时更新数据代理对象的值。通过这样的方式，我们实现了一个简单的双向数据绑定。</p>
<h2 id="48-如何理解-MVVM"><a href="#48-如何理解-MVVM" class="headerlink" title="48. 如何理解 MVVM"></a>48. 如何理解 MVVM</h2><p>MVVM（Model-View-ViewModel）模式是一种软件架构设计模式，主要用于分离应用程序的界面表示层（View）和业务逻辑层（Model）。它的核心思想是基于数据驱动的视图更新。ViewModel 作为 View 和 Model 之间的连接器，负责将 Model 中的数据转换成 View 可以显示的数据，并处理从 View 接收到的用户交互事件。MVVM 让应用程序的不同部分更容易分离、测试和维护。</p>
<p>MVVM 的优点如下：</p>
<ol>
<li>解耦：MVVM 模式可以将 UI（用户界面）和业务逻辑分离，在一定程度上简化了代码编写和程序设计。</li>
<li>双向数据绑定：ViewModel 和 View 之间的数据同步是自动完成的，这意味着当数据发生变化时，不需要手动更新视图，从而减少了很多重复和繁琐的工作。</li>
<li>可维护性：由于 UI 和业务逻辑分离，维护成本较低。当需要更新视图或业务逻辑时，可以只关注对应的部分，而不会对其他部分产生影响。</li>
<li>可测试性：可以对 ViewModel 进行单元测试，提高应用程序的可靠性和健壮性。</li>
<li>可重用性：可以重用 ViewModel 中的代码，提高开发效率。</li>
</ol>
<p>MVVM 的缺点如下：</p>
<ol>
<li>过度抽象：当应用程序的功能或逻辑不是很复杂时，MVVM 可能会导致过度抽象，增加了代码的复杂性和学习成本。</li>
<li>内存占用：由于持续监听数据变化和双向绑定，可能导致更高的内存占用和性能损失。</li>
<li>依赖框架：为实现 MVVM，通常需要依赖于特定的框架（如：Vue.js、Angular、React 等），在某种程度上限制了技术选型。</li>
</ol>
<p>总结一下，MVVM 为前端应用带来了更好的可维护性、可测试性和解耦。它尤其适用于复杂数字、逻辑复杂的大型应用程序。但对于简单的应用程序来说，可能会导致过度抽象和依赖于特定框架。</p>
<img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="./assets/09.png" align="left" width="70%"/>

<p>在 JavaScript 中，Object.create() 是一个用于创建新对象的方法。它是基于现有对象创建新对象的一种方式，新对象可以继承现有对象的属性和方法。</p>
<p>使用 Object.create() 方法时，需要传入一个原型对象作为参数。该方法将返回一个新对象，该对象的原型是传入的原型对象。这个新对象可以通过访问原型对象来获取属性和方法。</p>
<p>以下是一个简单的示例，说明如何使用 Object.create() 方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个原型对象</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;John&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">30</span>,</span><br><span class="line">  <span class="attr">greeting</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">      <span class="string">&quot;Hello, my name is &quot;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&quot; and I am &quot;</span> + <span class="variable language_">this</span>.<span class="property">age</span> + <span class="string">&quot; years old.&quot;</span></span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 Object.create() 方法创建一个新对象</span></span><br><span class="line"><span class="keyword">let</span> student = <span class="title class_">Object</span>.<span class="title function_">create</span>(person);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置新对象的属性</span></span><br><span class="line">student.<span class="property">name</span> = <span class="string">&quot;Jane&quot;</span>;</span><br><span class="line">student.<span class="property">age</span> = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用新对象的方法</span></span><br><span class="line">student.<span class="title function_">greeting</span>(); <span class="comment">// 输出：Hello, my name is Jane and I am 20 years old.</span></span><br></pre></td></tr></table></figure>

<p>在这个示例中，我们首先定义了一个名为 <code>person</code> 的原型对象，它有三个属性：<code>name</code>、<code>age</code> 和 <code>greeting</code>。然后，我们使用 <code>Object.create()</code> 方法创建了一个名为 <code>student</code> 的新对象，并将 <code>person</code> 对象作为其原型。最后，我们设置了 <code>student</code> 对象的 <code>name</code> 和 <code>age</code> 属性，并调用了其 <code>greeting()</code> 方法。</p>
<p>需要注意的是，使用 Object.create() 方法创建的新对象并不具有自己的属性和方法，它们都是从原型对象继承而来的。如果需要添加新的属性或方法，可以直接在新对象上定义。</p>
<h2 id="49-computed-计算属性"><a href="#49-computed-计算属性" class="headerlink" title="49 computed 计算属性"></a>49 computed 计算属性</h2><p>Vue 中的计算属性（Computed properties）是一种特殊类型的属性，它依赖其他属性值的变化进行自动计算和更新。</p>
<p>计算属性的主要作用是将一些复杂的逻辑和计算放入独立的属性中，使 Vue 模板更简洁、可读性更强。</p>
<p>计算属性具有以下特性：</p>
<ol>
<li>响应式依赖：计算属性依赖其他响应式属性值，当依赖属性值发生变化时，计算属性自动更新。</li>
<li>缓存优化：计算属性具有缓存机制，只有当依赖的属性值发生变化时，计算属性才重新计算值。否则，直接使用缓存的值。</li>
<li>可读性：通过计算属性可以将复杂数值计算和转换逻辑移到独立的属性中，使 Vue 模板更简洁、便于理解和维护。</li>
<li>支持 getter 和 setter：计算属性默认只有 getter 方法，但也可以指定一个 setter 方法，实现对计算属性的赋值操作。</li>
</ol>
<p>实际项目中，计算属性的应用主要包括：</p>
<ul>
<li>动态计算属性值：当一个属性值依赖于其他属性值时，可以使用计算属性。</li>
<li>格式化显示数据：当需要对数据进行格式化或转换时，可以使用计算属性。</li>
<li>过滤数组或对象：当需要根据一定条件筛选出数据列表或对象的子集时，可以使用计算属性。</li>
</ul>
<p>以下是一个代码示例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;firstName&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;First Name&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;lastName&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Last Name&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Full name: &#123;&#123; fullName &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">firstName</span>: <span class="string">&quot;John&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">lastName</span>: <span class="string">&quot;Doe&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">computed</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 计算属性 fullName 依赖于 firstName 和 lastName</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">fullName</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">firstName</span> + <span class="string">&quot; &quot;</span> + <span class="variable language_">this</span>.<span class="property">lastName</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在这个示例中，我们有两个输入框，用于填写名和姓。我们定义了一个计算属性 fullName，它的值依赖于 firstName 和 lastName。当我们在输入框中更改名字或姓氏时，fullName 自动更新，显示完整的名字。这使我们的模板非常简洁，便于理解。</p>
<h2 id="50-vue-data-函数"><a href="#50-vue-data-函数" class="headerlink" title="50. vue data 函数"></a>50. vue data 函数</h2><p>为什么 vue 中的 data 配置项必须是一个函数?</p>
<p>在 Vue 中，data 配置项必须是一个函数，主要原因是为了避免组件实例之间共享数据。</p>
<p>若不是一个函数，那么所有组件实例将引用相同的数据对象，这样当其中一个组件实例改变数据时，其他组件实例中的数据也将受到影响。</p>
<p>假设我们有一个简单的组件，用于显示一个计数器：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;counter&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">`&lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;`</span>,</span><br><span class="line">  <span class="attr">data</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>我们将 <code>data</code> 配置项定义为一个函数，它返回一个对象，包含该组件实例的初始数据。</p>
<p>在这个例子中，我们为每个 <code>counter</code> 组件实例定义了一个 <code>count</code> 属性，并将其初始值设置为 0。</p>
<p>当我们在应用程序中多次使用 <code>counter</code> 组件时：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">counter</span>&gt;</span><span class="tag">&lt;/<span class="name">counter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">counter</span>&gt;</span><span class="tag">&lt;/<span class="name">counter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">counter</span>&gt;</span><span class="tag">&lt;/<span class="name">counter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>每个组件实例都会拥有自己独立的 <code>count</code> 数据。可以想象，如果我们将 <code>data</code> 直接定义为一个对象，如下所示：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&quot;counter&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">`&lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;`</span>,</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>那么所有的 <code>counter</code> 组件实例将共享同一个 <code>count</code> 数据，并且当一个实例的 <code>count</code> 值发生变化时，其他实例的 <code>count</code> 值也会受到影响。</p>
<p>因此，将 <code>data</code> 定义为一个函数，确保了每个组件实例都能拥有独立的数据副本，从而避免了潜在的问题。</p>
<h2 id="51-vue2-抽取逻辑"><a href="#51-vue2-抽取逻辑" class="headerlink" title="51. vue2 抽取逻辑"></a>51. vue2 抽取逻辑</h2><p>如何将多个组件中的公共逻辑抽取出来？</p>
<p>在 Vue2 中，有两种主要的方式可以将多个组件中的相同逻辑抽取出来： Mixins（混入） 和高阶组件（Higher-Order Components，简称 HOC）。</p>
<ol>
<li>Mixins（混入）</li>
</ol>
<p>Mixins 是一种在多个组件之间共享可复用的功能的方法。一个 mixin 的方法可以被其他组件混入，这样这些组件就可以获得 mixin 中定义的数据、组件、指令、生命周期方法等。</p>
<p>假设我们有以下相同逻辑需要在多个组件中使用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// commonLogic.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&quot;Hello from mixin!&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">message</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">showAlert</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">message</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>在其他组件中使用 Mixin：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ComponentA.vue</span></span><br><span class="line"><span class="keyword">import</span> commonLogic <span class="keyword">from</span> <span class="string">&quot;./commonLogic.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">mixins</span>: [commonLogic],</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ComponentB.vue</span></span><br><span class="line"><span class="keyword">import</span> commonLogic <span class="keyword">from</span> <span class="string">&quot;./commonLogic.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">mixins</span>: [commonLogic],</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>高阶组件（Higher-Order Components）</li>
</ol>
<p>高阶组件（HOC）是一个接收组件作为参数并返回一个新组件的函数。该新组件包含了原组件的所有功能，并且可以向原组件注入新的逻辑。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// withCommonLogic.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">withCommonLogic</span>(<span class="params">WrappedComponent</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">`withCommonLogic(<span class="subst">$&#123;WrappedComponent.name&#125;</span>)`</span>,</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&quot;Hello from HOC!&quot;</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">message</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">methods</span>: &#123;</span><br><span class="line">      <span class="title function_">showAlert</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">message</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">render</span>(<span class="params">h</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">h</span>(<span class="title class_">WrappedComponent</span>, &#123;</span><br><span class="line">        <span class="attr">props</span>: <span class="variable language_">this</span>.<span class="property">$props</span>,</span><br><span class="line">        <span class="attr">on</span>: <span class="variable language_">this</span>.<span class="property">$listeners</span>,</span><br><span class="line">        <span class="attr">scopedSlots</span>: <span class="variable language_">this</span>.<span class="property">$scopedSlots</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在其他组件中使用 HOC：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ComponentA.vue</span></span><br><span class="line"><span class="keyword">import</span> withCommonLogic <span class="keyword">from</span> <span class="string">&quot;./withCommonLogic.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">withCommonLogic</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;ComponentA&quot;</span>,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ComponentB.vue</span></span><br><span class="line"><span class="keyword">import</span> withCommonLogic <span class="keyword">from</span> <span class="string">&quot;./withCommonLogic.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">withCommonLogic</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;ComponentB&quot;</span>,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>以上两种方法都可以在 Vue2 中将多个组件中的相同逻辑抽取出来。你可以根据具体的需求和项目场景决定使用哪种方式。</p>
<h2 id="52-vue2-异步组件"><a href="#52-vue2-异步组件" class="headerlink" title="52. vue2 异步组件"></a>52. vue2 异步组件</h2><p>异步组件在 Vue.js 中可以帮助我们实现代码分割和按需加载，优化性能和加载速度。这对于大型应用程序是非常有用的。以下是 4 个场景的例子：</p>
<p>(1) 路由懒加载</p>
<p>可以把某个路由对应的组件编写成异步组件，这样在初始加载时，只需要加载首页的组件，其他页面的组件可以在实际访问时按需加载。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Router</span> <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Router</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Foo</span> = (<span class="params"></span>) =&gt; <span class="keyword">import</span>(<span class="string">&quot;@/components/Foo.vue&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Bar</span> = (<span class="params"></span>) =&gt; <span class="keyword">import</span>(<span class="string">&quot;@/components/Bar.vue&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Router</span>(&#123;</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">&quot;/foo&quot;</span>, <span class="attr">component</span>: <span class="title class_">Foo</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">&quot;/bar&quot;</span>, <span class="attr">component</span>: <span class="title class_">Bar</span> &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>(2) 按需加载弹窗组件</p>
<p>某些场景下，我们需要在用户点击某个按钮后展示一个弹窗组件。这种组件在页面加载时可能并不需要，可以使用异步组件按需加载。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;openModal&quot;</span>&gt;</span>打开弹窗<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Modal</span> <span class="attr">v-if</span>=<span class="string">&quot;showModal&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">Modal</span> = (<span class="params"></span>) =&gt; <span class="keyword">import</span>(<span class="string">&quot;@/components/Modal.vue&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">showModal</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123; <span class="title class_">Modal</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">openModal</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">showModal</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>(3) 大型选项卡式应用</p>
<p>在一个包含多个选项卡的应用中，可以将每个选项卡对应的组件编写为异步组件，这样可以在切换选项卡时按需加载相应的组件。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tabs</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tab</span> <span class="attr">name</span>=<span class="string">&quot;A&quot;</span> <span class="attr">:component</span>=<span class="string">&quot;A&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">tab</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tab</span> <span class="attr">name</span>=<span class="string">&quot;B&quot;</span> <span class="attr">:component</span>=<span class="string">&quot;B&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">tab</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tab</span> <span class="attr">name</span>=<span class="string">&quot;C&quot;</span> <span class="attr">:component</span>=<span class="string">&quot;C&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">tab</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tabs</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">A</span> = (<span class="params"></span>) =&gt; <span class="keyword">import</span>(<span class="string">&quot;@/components/A.vue&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">B</span> = (<span class="params"></span>) =&gt; <span class="keyword">import</span>(<span class="string">&quot;@/components/B.vue&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">C</span> = (<span class="params"></span>) =&gt; <span class="keyword">import</span>(<span class="string">&quot;@/components/C.vue&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      A,</span></span><br><span class="line"><span class="language-javascript">      B,</span></span><br><span class="line"><span class="language-javascript">      C,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>(4) 根据不同设备加载不同组件</p>
<p>当我们需要根据不同设备展示不同的组件时，可以在运行时动态加载相应的异步组件。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;currentComponent&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">DesktopComponent</span> = (<span class="params"></span>) =&gt; <span class="keyword">import</span>(<span class="string">&quot;@/components/DesktopComponent.vue&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">MobileComponent</span> = (<span class="params"></span>) =&gt; <span class="keyword">import</span>(<span class="string">&quot;@/components/MobileComponent.vue&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">currentComponent</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">innerWidth</span> &lt; <span class="number">768</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">currentComponent</span> = <span class="title class_">MobileComponent</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">currentComponent</span> = <span class="title class_">DesktopComponent</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="53-vue-作用域插槽"><a href="#53-vue-作用域插槽" class="headerlink" title="53. vue 作用域插槽"></a>53. vue 作用域插槽</h2><p>Vue 中的作用域插槽（Scoped Slots）是一种特殊类型的插槽，它允许父组件向子组件传递数据，同时还允许子组件在其插槽中使用该数据。这使得子组件可以更灵活地渲染父组件传递的数据，而不仅仅是简单地显示它们。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">child-component</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:default</span>=<span class="string">&quot;slotProps&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123; slotProps.message &#125;&#125; World!</span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">child-component</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ChildComponent</span> <span class="keyword">from</span> <span class="string">&quot;./ChildComponent.vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ChildComponent</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">:message</span>=<span class="string">&quot;message&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">message</span>: <span class="string">&quot;Hello&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在这个示例中，父组件包含一个名为 child-component 的子组件。父组件使用 v-slot 指令来定义一个默认插槽，并将其绑定到一个名为 slotProps 的变量上。该变量是一个对象，其中包含子组件需要使用的数据。在这种情况下，子组件需要使用名为 message 的数据。</p>
<p>子组件包含一个名为 message 的数据属性，并将其传递给插槽。父组件中的模板使用 slotProps.message 来访问该数据，并将其与字符串 World!连接起来。</p>
<h2 id="54-vuex-action-mutation"><a href="#54-vuex-action-mutation" class="headerlink" title="54. vuex action mutation"></a>54. vuex action mutation</h2><p>在 Vuex 中，mutation 和 action 都是用于管理应用程序状态的重要概念。</p>
<p>它们的作用是不同的，mutation 用于修改状态，而 action 用于处理异步逻辑。</p>
<p>mutation 是 Vuex 中用于修改状态的方法。它们必须是同步的，这意味着它们不能包含异步逻辑。mutation 只能通过提交(commit)来调用。</p>
<p>下面是一个简单的示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      state.<span class="property">count</span>++;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">commit</span>(<span class="string">&quot;increment&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>action 是 Vuex 中用于处理异步逻辑的方法。它们可以包含任何异步代码，例如 API 调用或 setTimeout()函数。action 可以通过 dispatch 来调用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      state.<span class="property">count</span>++;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">incrementAsync</span>(<span class="params">context</span>) &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        context.<span class="title function_">commit</span>(<span class="string">&quot;increment&quot;</span>);</span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">dispatch</span>(<span class="string">&quot;incrementAsync&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="55-vue-router-路由模式"><a href="#55-vue-router-路由模式" class="headerlink" title="55. vue router 路由模式"></a>55. vue router 路由模式</h2><p>Vue Router 提供了三种路由模式：hash 模式、history 模式和 abstract 模式。</p>
<p>(1) Hash 模式</p>
<p>Hash 模式使用 URL 的 hash 部分（即#号后面的内容）来管理路由。在这种模式下，当 URL 的 hash 部分发生变化时，Vue Router 会自动更新视图。Hash 模式不需要服务器配置，因此它非常适合在静态文件服务器上部署单页应用程序。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;hash&#x27;</span>,</span><br><span class="line">  <span class="attr">routes</span>: [...]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>(2) History 模式</p>
<p>History 模式使用 HTML5 History API 来管理路由。在这种模式下，URL 的路径部分被用来管理路由。当 URL 的路径部分发生变化时，Vue Router 会自动更新视图。History 模式需要服务器配置，以便在用户直接访问页面时正确地响应请求。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;history&#x27;</span>,</span><br><span class="line">  <span class="attr">routes</span>: [...]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>(3) Abstract 模式</p>
<p>Abstract 模式不会改变浏览器的 URL，而是将路由信息保存在内存中。这种模式常用于服务器端渲染或单元测试中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;abstract&#x27;</span>,</span><br><span class="line">  <span class="attr">routes</span>: [...]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>在选择路由模式时，需要考虑以下几个因素：</p>
<ol>
<li><p>服务器配置：如果你的应用程序需要在服务器上运行，则需要选择支持 HTML5 History API 的路由模式。</p>
</li>
<li><p>SEO 优化：如果你的应用程序需要进行 SEO 优化，则需要选择支持 HTML5 History API 的路由模式。</p>
</li>
<li><p>兼容性：如果你的应用程序需要在旧版浏览器上运行，则需要选择支持 Hash 模式的路由模式。</p>
</li>
</ol>
<p>综上所述，选择哪种路由模式取决于你的应用程序的需求和服务器配置。</p>
<p>在大多数情况下，我们建议使用 History 模式，因为它可以提供更好的用户体验和 SEO 优化。</p>
<h2 id="55-JavaScript-模拟前端路由"><a href="#55-JavaScript-模拟前端路由" class="headerlink" title="55. JavaScript 模拟前端路由"></a>55. JavaScript 模拟前端路由</h2><p>前端路由可以通过监听 URL 的变化，并根据 URL 的不同渲染不同的视图来实现。下面是使用 JavaScript 模拟前端路由的示例代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = &#123;</span><br><span class="line">  <span class="string">&quot;/&quot;</span>: home,</span><br><span class="line">  <span class="string">&quot;/about&quot;</span>: about,</span><br><span class="line">  <span class="string">&quot;/contact&quot;</span>: contact,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> content = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.content&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">render</span>(<span class="params">path</span>) &#123;</span><br><span class="line">  content.<span class="property">innerHTML</span> = routes[path];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">router</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> path = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>;</span><br><span class="line">  <span class="title function_">render</span>(path);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;popstate&quot;</span>, router);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (e.<span class="property">target</span>.<span class="property">tagName</span> === <span class="string">&quot;A&quot;</span>) &#123;</span><br><span class="line">      e.<span class="title function_">preventDefault</span>();</span><br><span class="line">      <span class="keyword">const</span> href = e.<span class="property">target</span>.<span class="title function_">getAttribute</span>(<span class="string">&quot;href&quot;</span>);</span><br><span class="line">      <span class="variable language_">window</span>.<span class="property">history</span>.<span class="title function_">pushState</span>(<span class="literal">null</span>, <span class="literal">null</span>, href);</span><br><span class="line">      <span class="title function_">router</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">router</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>在这个示例中，我们首先定义了一个 routes 对象，其中包含了不同路径对应的视图。</p>
<p>然后，我们定义了一个 render 函数，用于根据 URL 渲染不同的视图。</p>
<p>接下来，我们定义了一个 router 函数，用于监听 popstate 事件并根据 URL 的变化渲染不同的视图。我们还在 DOMContentLoaded 事件中添加了一个事件监听器，用于处理用户点击链接时的行为。当用户点击链接时，我们使用 pushState 方法将新的 URL 添加到浏览器历史记录中，并调用 router 函数来渲染新的视图。</p>
<p>最后，在 DOMContentLoaded 事件中调用 router 函数来初始化路由，并开始监听 popstate 事件的触发。</p>
<p>需要注意的是，这只是一个简单的示例代码，实际的前端路由实现可能需要更复杂的逻辑和处理。</p>
<p>在 JavaScript 中，执行顺序是由事件循环（Event Loop）来实现的。事件循环中主要有两种任务：宏任务（Macro-task）和微任务（Micro-task）。DOM 渲染通常在宏任务和微任务之间执行。</p>
<p>执行顺序如下：</p>
<ol>
<li>首先处理宏任务（例如整个 script 代码执行完毕）</li>
<li>完成 DOM 渲染。</li>
<li>处理微任务队列中的所有微任务</li>
<li>进行下一轮的宏任务（例如 setTimeout）</li>
</ol>
<p>依赖注入（Dependency Injection，简称 DI）是一种软件设计模式，它通过将对象的依赖关系从对象内部解耦，使得对象实例在运行时可以更加灵活地接收依赖项。依赖注入主要有以下好处：</p>
<ol>
<li>提高了代码的可维护性，使得组件之间的耦合度降低。</li>
<li>提高了代码的可测试性，因为依赖关系可以根据测试需求动态注入。</li>
</ol>
<p>下面举一个简单的 TypeScript 代码例子说明依赖注入的工作方式。</p>
<p>假设我们需要为一个电子商务系统设计一个购物车功能。购物字功能内部需要调用一系列子服务，例如库存服务、付款服务和邮寄服务。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义子服务</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IStockService</span> &#123;</span><br><span class="line">  <span class="title function_">checkStock</span>(<span class="attr">product</span>: <span class="built_in">string</span>): <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IPayService</span> &#123;</span><br><span class="line">  <span class="title function_">pay</span>(<span class="attr">amount</span>: <span class="built_in">number</span>): <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IShippingService</span> &#123;</span><br><span class="line">  <span class="title function_">ship</span>(<span class="attr">products</span>: <span class="built_in">string</span>[], <span class="attr">address</span>: <span class="built_in">string</span>): <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建依赖于子服务的购物车类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ShoppingCart</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">stockService</span>: <span class="title class_">IStockService</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">payService</span>: <span class="title class_">IPayService</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">shippingService</span>: <span class="title class_">IShippingService</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    stockService: IStockService,</span></span><br><span class="line"><span class="params">    payService: IPayService,</span></span><br><span class="line"><span class="params">    shippingService: IShippingService</span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">stockService</span> = stockService;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">payService</span> = payService;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">shippingService</span> = shippingService;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">purchase</span>(<span class="attr">products</span>: <span class="built_in">string</span>[], <span class="attr">address</span>: <span class="built_in">string</span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> product <span class="keyword">of</span> products) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">stockService</span>.<span class="title function_">checkStock</span>(product)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`库存不足: <span class="subst">$&#123;product&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> amount = products.<span class="property">length</span> * <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">payService</span>.<span class="title function_">pay</span>(amount)) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;付款失败&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">shippingService</span>.<span class="title function_">ship</span>(products, address)) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;邮寄失败&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;购物成功&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这个例子中，购物车类（ShoppingCart）的实例需要接收三个子服务实例作为创建实例的输入。这样做的好处是：</p>
<ul>
<li>查看购物车类，可以很明显地看到它依赖于哪些子服务，便于理解和维护。</li>
<li>在运行时，可以根据需要灵活地为购物车类注入不同版本的子服务，例如在测试环境中使用模拟数据的子服务。</li>
</ul>
<p>为了完成依赖注入，你需要创建子服务的实现类并将它们传递给购物车类。例如，你可以这样使用购物车类：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义子服务的实现类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StockService</span> <span class="keyword">implements</span> <span class="title class_">IStockService</span> &#123;</span><br><span class="line">  <span class="title function_">checkStock</span>(<span class="attr">product</span>: <span class="built_in">string</span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 在实际项目中，此处应从数据库或其他来源检查库存</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PayService</span> <span class="keyword">implements</span> <span class="title class_">IPayService</span> &#123;</span><br><span class="line">  <span class="title function_">pay</span>(<span class="attr">amount</span>: <span class="built_in">number</span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 在实际项目中，此处应调用支付接口完成付款</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ShippingService</span> <span class="keyword">implements</span> <span class="title class_">IShippingService</span> &#123;</span><br><span class="line">  <span class="title function_">ship</span>(<span class="attr">products</span>: <span class="built_in">string</span>[], <span class="attr">address</span>: <span class="built_in">string</span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 在实际项目中，此处应调用物流接口完成邮寄</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实例化子服务</span></span><br><span class="line"><span class="keyword">const</span> stockService = <span class="keyword">new</span> <span class="title class_">StockService</span>();</span><br><span class="line"><span class="keyword">const</span> payService = <span class="keyword">new</span> <span class="title class_">PayService</span>();</span><br><span class="line"><span class="keyword">const</span> shippingService = <span class="keyword">new</span> <span class="title class_">ShippingService</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 依赖注入：实例化购物车类，并将子服务的实例注入</span></span><br><span class="line"><span class="keyword">const</span> shoppingCart = <span class="keyword">new</span> <span class="title class_">ShoppingCart</span>(</span><br><span class="line">  stockService,</span><br><span class="line">  payService,</span><br><span class="line">  shippingService</span><br><span class="line">);</span><br><span class="line">shoppingCart.<span class="title function_">purchase</span>([<span class="string">&quot;product-1&quot;</span>, <span class="string">&quot;product-2&quot;</span>], <span class="string">&quot;北京市海淀区&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>在这个例子中，我们首先实现了子服务的实现类，接着创建了子服务的实例，最后将他们注入到购物车类中。这样就实现了购物车类对子服务的灵活依赖。</p>


<div class="article-footer reveal fs14"><section id="license"><div class="header"><span>许可协议</span></div><div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div></section></div>

</article>

<div class="related-wrap reveal" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">较新文章</div><a href="/%E9%9D%A2%E8%AF%95%E9%A2%98/React%E9%9D%A2%E8%AF%95%E9%A2%98/">React面试题</a></div><div class="item" id="next"><div class="note">较早文章</div><a href="/%E9%9D%A2%E8%AF%95%E9%A2%98/CSS%E9%9D%A2%E8%AF%95%E9%A2%98/">CSS面试题</a></div></section></div>








      
<footer class="page-footer reveal fs12"><hr><div class="sitemap"><div class="sitemap-group"><span class="fs14">博客</span><a href="/">近期</a><a href="/archives">归档</a><a href="/categories">分类</a><a href="/tags">标签</a></div><div class="sitemap-group"><span class="fs14">更多</span><a href="/">关于本站</a><a target="_blank" rel="noopener" href="https://github.com/mistbollon">GitHub</a></div><div class="sitemap-group"><span class="fs14">项目</span><a target="_blank" rel="noopener" href="https://github.com/mistbollon?tab=repositories">开源库</a></div></div><div class="text"><p>本站由 <a href="/">@GuoPeng</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar">Stellar</a> 主题创建。<br>本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p>
</div></footer>

      <div class='float-panel mobile-only blur' style='display:none'>
  <button type='button' class='sidebar-toggle mobile' onclick='sidebar.toggle()'>
    <svg class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15301"><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 2.3 26.8 24.6 47.5 51.6 47.6h416.5v4z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15302"></path><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 1.9 27.7 23.9 49.7 51.6 51.6h416.5z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15303"></path></svg>
  </button>
</div>

    </div>
  </div>
  <div class='scripts'>
    <script type="text/javascript">
  const stellar = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    loadCSS: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    // 从 butterfly 和 volantis 获得灵感
    loadScript: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    // https://github.com/jerryc127/hexo-theme-butterfly
    jQuery: (fn) => {
      if (typeof jQuery === 'undefined') {
        stellar.loadScript(stellar.plugins.jQuery).then(fn)
      } else {
        fn()
      }
    }
  };
  stellar.version = '1.18.5';
  stellar.github = 'https://github.com/xaoxuu/hexo-theme-stellar/tree/1.18.5';
  stellar.config = {
    date_suffix: {
      just: '刚刚',
      min: '分钟前',
      hour: '小时前',
      day: '天前',
      month: '个月前',
    },
  };

  // required plugins (only load if needs)
  stellar.plugins = {
    jQuery: 'https://gcore.jsdelivr.net/npm/jquery@3.6.2/dist/jquery.min.js'
  };

  if ('local_search') {
    stellar.search = {};
    stellar.search.service = 'local_search';
    if (stellar.search.service == 'local_search') {
      let service_obj = Object.assign({}, {"field":"all","path":"/search.json","content":true,"sort":"-date"});
      stellar.search[stellar.search.service] = service_obj;
    }
  }

  // stellar js
  stellar.plugins.stellar = Object.assign({"sites":"/js/plugins/sites.js","friends":"/js/plugins/friends.js","ghinfo":"/js/plugins/ghinfo.js","timeline":"/js/plugins/timeline.js","linkcard":"/js/plugins/linkcard.js","fcircle":"/js/plugins/fcircle.js","weibo":"/js/plugins/weibo.js"});

  stellar.plugins.marked = Object.assign("https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js");
  // optional plugins
  if ('true' == 'true') {
    stellar.plugins.lazyload = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/vanilla-lazyload@17.8.3/dist/lazyload.min.js","transition":"blur"});
  }
  if ('true' == 'true') {
    stellar.plugins.swiper = Object.assign({"enable":true,"css":"https://unpkg.com/swiper@8.4.5/swiper-bundle.min.css","js":"https://unpkg.com/swiper@8.4.5/swiper-bundle.min.js"});
  }
  if ('' == 'true') {
    stellar.plugins.scrollreveal = Object.assign({"enable":null,"js":"https://gcore.jsdelivr.net/npm/scrollreveal@4.0.9/dist/scrollreveal.min.js","distance":"8px","duration":500,"interval":100,"scale":1});
  }
  if ('true' == 'true') {
    stellar.plugins.preload = Object.assign({"enable":true,"service":"flying_pages","instant_page":"https://gcore.jsdelivr.net/gh/volantis-x/cdn-volantis@4.1.2/js/instant_page.js","flying_pages":"https://gcore.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.fancybox = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js","css":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css","selector":".swiper-slide img"});
  }
  if ('false' == 'true') {
    stellar.plugins.heti = Object.assign({"enable":false,"css":"https://unpkg.com/heti@0.9.2/umd/heti.min.css","js":"https://unpkg.com/heti@0.9.2/umd/heti-addon.min.js"});
  }
</script>

<!-- required -->

  
<script src="/js/main.js" async></script>



<!-- optional -->



<!-- inject -->


  </div>
</body>
</html>
